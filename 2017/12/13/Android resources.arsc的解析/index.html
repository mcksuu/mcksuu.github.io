<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Nick, Ksuu" />








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.png?v=5.1.0" />






<meta name="description" content="&amp;#x5199;&amp;#x5728;&amp;#x524D;&amp;#x9762;&amp;#x7684;&amp;#x8BDD;
&amp;#x4ECE;&amp;#x5199;&amp;#x4E0B;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6807;&amp;#x9898;&amp;#x5F00;&amp;#x59CB;&amp;#xFF0C;&amp;#x6211;&amp;#x5C31;&amp;#x77E5;&amp;#x9053;&amp;#x8FD9;&amp;#x7BC7;&amp;#x6587;&amp;#x7AE0;&amp;#x9700">
<meta property="og:type" content="article">
<meta property="og:title" content="Android resources.arsc的解析">
<meta property="og:url" content="https://mcksuu.github.io/2017/12/13/Android resources.arsc的解析/index.html">
<meta property="og:site_name" content="McKsuu">
<meta property="og:description" content="&amp;#x5199;&amp;#x5728;&amp;#x524D;&amp;#x9762;&amp;#x7684;&amp;#x8BDD;
&amp;#x4ECE;&amp;#x5199;&amp;#x4E0B;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6807;&amp;#x9898;&amp;#x5F00;&amp;#x59CB;&amp;#xFF0C;&amp;#x6211;&amp;#x5C31;&amp;#x77E5;&amp;#x9053;&amp;#x8FD9;&amp;#x7BC7;&amp;#x6587;&amp;#x7AE0;&amp;#x9700">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5720362-77b135eac18850e2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5720362-f3b58e036ddfddf2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5720362-00174d8fd407b4f2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5720362-8828d523ff23bbfe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5720362-bb8832785c808c9f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5720362-133b6cfaffa28b86.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5720362-d8ad7715761bf23e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5720362-7b3d16571390e374.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5720362-e5554eae0b8221b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5720362-45d7ebba8a597660.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5720362-86cd054b4ce38725.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/5720362-44534b4b3cbfa37f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2017-12-13T15:57:32.278Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android resources.arsc的解析">
<meta name="twitter:description" content="&amp;#x5199;&amp;#x5728;&amp;#x524D;&amp;#x9762;&amp;#x7684;&amp;#x8BDD;
&amp;#x4ECE;&amp;#x5199;&amp;#x4E0B;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6807;&amp;#x9898;&amp;#x5F00;&amp;#x59CB;&amp;#xFF0C;&amp;#x6211;&amp;#x5C31;&amp;#x77E5;&amp;#x9053;&amp;#x8FD9;&amp;#x7BC7;&amp;#x6587;&amp;#x7AE0;&amp;#x9700">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/5720362-77b135eac18850e2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://mcksuu.github.io/2017/12/13/Android resources.arsc的解析/"/>





  <title> Android resources.arsc的解析 | McKsuu </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">McKsuu</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle">McKsuu</p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://mcksuu.github.io/2017/12/13/Android resources.arsc的解析/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Nick Kang">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/favicon.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="McKsuu">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="McKsuu" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Android resources.arsc的解析
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="post.created" itemprop="dateCreated datePublished" datetime="2017-12-13T23:58:50+08:00">
                2017-12-13
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="&#x5199;&#x5728;&#x524D;&#x9762;&#x7684;&#x8BDD;"><a href="#&#x5199;&#x5728;&#x524D;&#x9762;&#x7684;&#x8BDD;" class="headerlink" title="&#x5199;&#x5728;&#x524D;&#x9762;&#x7684;&#x8BDD;"></a>&#x5199;&#x5728;&#x524D;&#x9762;&#x7684;&#x8BDD;</h1><blockquote>
<p>&#x4ECE;&#x5199;&#x4E0B;&#x8FD9;&#x4E2A;&#x6807;&#x9898;&#x5F00;&#x59CB;&#xFF0C;&#x6211;&#x5C31;&#x77E5;&#x9053;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x9700;&#x8981;&#x51E0;&#x5929;&#x7684;&#x65F6;&#x95F4;&#x624D;&#x80FD;&#x771F;&#x6B63;&#x5B8C;&#x6210;&#x3002;&#x5F53;&#x7136;&#x4E0D;&#x662F;&#x56E0;&#x4E3A;&#x4E00;&#x5207;&#x4ECE;&#x96F6;&#x5F00;&#x59CB;&#xFF0C;&#x53EA;&#x662F;&#x56E0;&#x4E3A;&#x8981;&#x6574;&#x7406;&#x7684;&#x4E1C;&#x897F;&#x592A;&#x591A;&#x3002;&#x8BF4;&#x51E0;&#x53E5;&#x9898;&#x5916;&#x8BDD;&#xFF0C;&#x5173;&#x4E8E;&#x4E3A;&#x5565;&#x8981;&#x5199;&#x8FD9;&#x4E2A;resources.arsc&#x6587;&#x4EF6;&#x7684;&#x89E3;&#x6790;&#x3002;&#x672C;&#x6765;&#x554A;&#xFF0C;&#x60F3;&#x6309;&#x7167;&#x6211;&#x4E4B;&#x524D;&#x5199;&#x7684;&#x4E00;&#x6B65;&#x6B65;&#x5199;&#x4E0B;&#x53BB;&#xFF0C;&#x7ED3;&#x679C;&#x4E00;&#x5929;&#x65E0;&#x804A;&#x770B;&#x6587;&#x7AE0;&#xFF0C;&#x53D1;&#x73B0;&#x4E86;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x89E3;&#x6790;&#x8FC7;&#x7A0B;&#x3002;&#x60F3;&#x8D77;&#x6211;&#x7684;&#x820D;&#x53CB;&#xFF08;&#x6280;&#x672F;&#x5927;&#x4F6C;&#xFF09;&#x5199;&#x8FC7;&#x4E00;&#x7BC7;&#x5173;&#x4E8E;<strong>.class</strong>&#x6587;&#x4EF6;&#x7684;&#x89E3;&#x6790;&#xFF08;&#x5F88;&#x60ED;&#x6127;&#xFF0C;&#x6211;&#x4E5F;&#x7167;&#x7740;&#x5199;&#x4E86;&#x4E00;&#x904D;&#xFF0C;&#x8FD8;&#x53D1;&#x73B0;&#x4E86;&#x70B9;&#x5C0F;&#x95EE;&#x9898;&#xFF09;&#xFF0C;&#x6240;&#x4EE5;&#x770B;&#x5230;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x53C8;&#x52FE;&#x8D77;&#x6211;&#x5BF9;&#x4E8C;&#x8FDB;&#x5236;&#x6587;&#x4EF6;&#x89E3;&#x6790;&#x7684;&#x5174;&#x8DA3;&#xFF08;&#x75DB;&#x82E6;&#x554A;&#xFF01;&#xFF01;&#xFF09;&#x3002;&#x5199;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x5DF2;&#x7ECF;&#x57FA;&#x672C;&#x5B9E;&#x73B0;&#x4E86;&#x6574;&#x4E2A;&#x89E3;&#x6790;&#x8FC7;&#x7A0B;&#xFF0C;&#x4F46;&#x662F;&#x5176;&#x4E2D;&#x6211;&#x6D4B;&#x8BD5;&#x4E86;&#x4E03;&#x4E2A;&#x4E0D;&#x540C;&#x7684;resources.arsc&#xFF0C;&#x53EA;&#x6709;&#x652F;&#x4ED8;&#x5B9D;&#x7684;&#x89E3;&#x6790;&#x4F1A;&#x6709;&#x95EE;&#x9898;&#xFF0C;wtf&#xFF01;&#xFF01;&#x6CA1;&#x529E;&#x6CD5;&#xFF0C;&#x6700;&#x540E;&#x6253;&#x5F00;&#x4E8C;&#x8FDB;&#x5236;&#x6587;&#x4EF6;&#xFF0C;&#x4E00;&#x70B9;&#x70B9;&#x627E;&#x95EE;&#x9898;&#xFF0C;&#x6700;&#x540E;&#x901A;&#x8FC7;&#x6211;&#x5F3A;&#x5927;&#x7684;&#x586B;&#x5751;&#x6280;&#x672F;&#xFF0C;&#x7EC8;&#x4E8E;&#x5B8C;&#x6210;&#x3002;&#x4E0D;&#x8FC7;&#x5462;&#xFF0C;&#x8FD9;&#x6B21;&#x4E0D;&#x6253;&#x7B97;&#x901A;&#x8FC7;<code>FileInputStream</code>&#x4E00;&#x70B9;&#x70B9;&#x53BB;<code>read</code>&#x5B9E;&#x73B0;&#xFF0C;&#x6211;&#x4F1A;&#x4F7F;&#x7528;<code>ByteArray</code>&#x6765;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x89E3;&#x6790;&#x8FC7;&#x7A0B;&#xFF0C;&#x6574;&#x4E2A;&#x5B9E;&#x73B0;&#x8FC7;&#x7A0B;&#x662F;kotlin&#x8BED;&#x8A00;&#xFF0C;&#x5F88;&#x591A;&#x4E0D;&#x719F;&#x6089;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x8FD8;&#x6709;&#x5F88;&#x591A;&#x9AD8;&#x7EA7;&#x7528;&#x6CD5;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x3002;</p>
</blockquote>
<hr>
<h1 id="1-&#x5173;&#x4E8E;resources-arsc&#x7684;&#x7F51;&#x4F20;&#x795E;&#x56FE;"><a href="#1-&#x5173;&#x4E8E;resources-arsc&#x7684;&#x7F51;&#x4F20;&#x795E;&#x56FE;" class="headerlink" title="1. &#x5173;&#x4E8E;resources.arsc&#x7684;&#x7F51;&#x4F20;&#x795E;&#x56FE;"></a>1. &#x5173;&#x4E8E;resources.arsc&#x7684;&#x7F51;&#x4F20;&#x795E;&#x56FE;</h1><blockquote>
<p>&#x7F51;&#x4E0A;&#x641C;&#x7D22;&#x5173;&#x4E8E;resources.arsc&#x6587;&#x4EF6;&#xFF0C;&#x4E00;&#x822C;&#x4F1A;&#x51FA;&#x73B0;&#x8001;&#x7F57;&#x7684;&#x6253;&#x5305;&#x8FC7;&#x7A0B;&#x4EE5;&#x53CA;&#x5C3C;&#x53E4;&#x62C9;&#x65AF;_&#x8D75;&#x56DB;&#x8FD9;&#x4E24;&#x4F4D;&#x771F;&#x795E;&#x7684;&#x8BB2;&#x89E3;&#x3002;&#x5176;&#x4E2D;&#x8001;&#x7F57;&#x7684;&#x8BB2;&#x89E3;&#x4E2D;&#x51FA;&#x73B0;&#x4E86;&#x4E00;&#x5E45;&#x56FE;&#x7247;&#xFF0C;&#x5173;&#x4E8E;resources.arsc&#x7684;&#x683C;&#x5F0F;&#x3002;&#x56FE;&#x7247;&#x5982;&#x4E0B;&#xFF1A;<br><img src="http://upload-images.jianshu.io/upload_images/5720362-77b135eac18850e2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="resources.arsc&#x683C;&#x5F0F;"></p>
</blockquote>
<hr>
<h1 id="2-resources-arsc&#x683C;&#x5F0F;&#x8BE6;&#x7EC6;&#x5206;&#x6790;"><a href="#2-resources-arsc&#x683C;&#x5F0F;&#x8BE6;&#x7EC6;&#x5206;&#x6790;" class="headerlink" title="2. resources.arsc&#x683C;&#x5F0F;&#x8BE6;&#x7EC6;&#x5206;&#x6790;"></a>2. resources.arsc&#x683C;&#x5F0F;&#x8BE6;&#x7EC6;&#x5206;&#x6790;</h1><blockquote>
<p>&#x6309;&#x7167;&#x4E0A;&#x9762;&#x7684;&#x56FE;&#x7247;&#x6765;&#x8BF4;&#xFF0C;&#x6574;&#x4E2A;resources.arsc&#x6587;&#x4EF6;&#x5206;&#x4E3A;&#x4E86;&#x516D;&#x4E2A;&#x90E8;&#x5206;&#xFF08;&#x6682;&#x65F6;&#x6309;&#x7167;&#x989C;&#x8272;&#x5206;&#x5427;&#xFF09;&#xFF0C;&#x8FD9;&#x51E0;&#x4E2A;&#x90E8;&#x5206;&#x53EF;&#x80FD;&#x5C31;&#x662F;&#x4ED6;&#x4EEC;&#x6240;&#x8BF4;&#x7684;chunk&#x628A;&#xFF0C;&#x4ECE;&#x4E0A;&#x5230;&#x4E0B;&#x4F9D;&#x6B21;&#x662F;&#xFF1A;</p>
<ol>
<li>package&#x6570;&#x91CF;</li>
<li>String Pool&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x6C60;</li>
<li>Package &#x4FE1;&#x606F;</li>
<li>&#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x548C;&#x8D44;&#x6E90;&#x9879;&#x540D;&#x79F0;&#x5B57;&#x7B26;&#x4E32;&#x6C60;</li>
<li>&#x7C7B;&#x578B;&#x89C4;&#x8303;&#x6570;&#x636E;&#x5757;</li>
<li>&#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x9879;&#x6570;&#x636E;&#x5757;</li>
</ol>
</blockquote>
<hr>
<h1 id="3-&#x5148;&#x8BF4;&#x8BF4;&#x5934;&#x90E8;&#x4FE1;&#x606F;"><a href="#3-&#x5148;&#x8BF4;&#x8BF4;&#x5934;&#x90E8;&#x4FE1;&#x606F;" class="headerlink" title="3. &#x5148;&#x8BF4;&#x8BF4;&#x5934;&#x90E8;&#x4FE1;&#x606F;"></a>3. &#x5148;&#x8BF4;&#x8BF4;&#x5934;&#x90E8;&#x4FE1;&#x606F;</h1><blockquote>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4ECE;&#x56FE;&#x4E2D;&#x770B;&#x5230;&#xFF0C;&#x6BCF;&#x5757;&#x7ED3;&#x6784;&#x90FD;&#x662F;&#x4EE5;TYPE&#x3001;&#x5934;&#x5927;&#x5C0F;&#x3001;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x5F00;&#x5934;&#xFF0C;&#x8FD9;&#x4E00;&#x90E8;&#x5206;&#x7EC4;&#x6210;&#x4E86;&#x5934;&#x90E8;&#x7684;&#x4FE1;&#x606F;&#x6839;&#x636E;ResourceTypes.h&#x7684;&#x8BF4;&#x660E;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#xFF0C;&#x8FD9;&#x90E8;&#x5206;&#x662F;chunk&#x7684;&#x5934;&#x90E8;&#xFF0C;&#x5148;&#x770B;&#x4E0B;&#x5B9A;&#x4E49;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line">ResourceTypes.h &#x5B9A;&#x4E49;</div><div class="line">/**</div><div class="line"> * Header that appears at the front of every data chunk in a resource.</div><div class="line"> */</div><div class="line">struct ResChunk_header</div><div class="line">{</div><div class="line">    // Type identifier for this chunk.  The meaning of this value depends</div><div class="line">    // on the containing chunk.</div><div class="line">    uint16_t type;</div><div class="line"></div><div class="line">    // Size of the chunk header (in bytes).  Adding this value to</div><div class="line">    // the address of the chunk allows you to find its associated data</div><div class="line">    // (if any).</div><div class="line">    uint16_t headerSize;</div><div class="line"></div><div class="line">    // Total size of this chunk (in bytes).  This is the chunkSize plus</div><div class="line">    // the size of any data associated with the chunk.  Adding this value</div><div class="line">    // to the chunk allows you to completely skip its contents (including</div><div class="line">    // any child chunks).  If this value is the same as chunkSize, there is</div><div class="line">    // no data associated with the chunk.</div><div class="line">    uint32_t size;</div><div class="line">};</div><div class="line">ResChunk_header&#x5B9A;&#x4E49;</div><div class="line">class ResChunk_header(var type: uint16_t, //&#x5F53;&#x524D;&#x8FD9;&#x4E2A;chunk&#x7684;&#x7C7B;&#x578B;</div><div class="line">                      var headerSize: uint16_t, //&#x5F53;&#x524D;&#x8FD9;&#x4E2A;chunk&#x7684;&#x5934;&#x90E8;&#x5927;&#x5C0F;</div><div class="line">                      var size: uint32_t) { //&#x5F53;&#x524D;&#x8FD9;&#x4E2A;chunk&#x7684;&#x5927;&#x5C0F;</div><div class="line">    //&#x8FD9;&#x5730;&#x65B9;&#x53EF;&#x4EE5;&#x6539;&#x6210;companion object&#xFF0C;&#x61D2;&#x5F97;&#x6539;&#x4E86;</div><div class="line">    enum class ChunkType(var type: Int) {</div><div class="line">        RES_NULL_TYPE(0x0000),</div><div class="line">        RES_STRING_POOL_TYPE(0x0001),</div><div class="line">        RES_TABLE_TYPE(0x0002),</div><div class="line">        RES_XML_TYPE(0x0003),</div><div class="line">        RES_XML_FIRST_CHUNK_TYPE(0x0100),</div><div class="line">        RES_XML_START_NAMESPACE_TYPE(0x0100),</div><div class="line">        RES_XML_END_NAMESPACE_TYPE(0x0101),</div><div class="line">        RES_XML_START_ELEMENT_TYPE(0x0102),</div><div class="line">        RES_XML_END_ELEMENT_TYPE(0x0103),</div><div class="line">        RES_XML_CDATA_TYPE(0x0104),</div><div class="line">        RES_XML_LAST_CHUNK_TYPE(0x017f),</div><div class="line">        RES_XML_RESOURCE_MAP_TYPE(0x0180),</div><div class="line">        RES_TABLE_PACKAGE_TYPE(0x0200),</div><div class="line">        RES_TABLE_TYPE_TYPE(0x0201),</div><div class="line">        RES_TABLE_TYPE_SPEC_TYPE(0x0202)</div><div class="line"></div><div class="line">    }</div><div class="line">    // &#x8F93;&#x51FA;&#x5934;&#x90E8;&#x4FE1;&#x606F;</div><div class="line">    override fun toString(): String {</div><div class="line">        return &quot;type = ${getType(type)}, typeHexValue = ${type.getHexValue()}, headerSize = ${headerSize.getValue()}, headerHexValue = ${headerSize.getHexValue()}, size = ${size.getValue()}, sizeHexValue = ${size.getHexValue()}&quot;</div><div class="line">    }</div><div class="line">    // &#x83B7;&#x5F97;&#x7C7B;&#x578B;</div><div class="line">    fun getType(type: uint16_t): String {</div><div class="line">        when (type.getValue().toInt()) {</div><div class="line">            ResChunk_header.ChunkType.RES_NULL_TYPE.type -&gt; return &quot;RES_NULL_TYPE&quot;</div><div class="line">            ResChunk_header.ChunkType.RES_STRING_POOL_TYPE.type -&gt; return &quot;RES_STRING_POOL_TYPE&quot;</div><div class="line">            ResChunk_header.ChunkType.RES_TABLE_TYPE.type -&gt; return &quot;RES_TABLE_TYPE&quot;</div><div class="line">            ResChunk_header.ChunkType.RES_XML_TYPE.type -&gt; return &quot;RES_XML_TYPE&quot;</div><div class="line">            ResChunk_header.ChunkType.RES_XML_FIRST_CHUNK_TYPE.type -&gt; return &quot;RES_XML_FIRST_CHUNK_TYPE&quot;</div><div class="line">            ResChunk_header.ChunkType.RES_XML_START_NAMESPACE_TYPE.type -&gt; return &quot;RES_XML_START_NAMESPACE_TYPE&quot;</div><div class="line">            ResChunk_header.ChunkType.RES_XML_END_NAMESPACE_TYPE.type -&gt; return &quot;RES_XML_END_NAMESPACE_TYPE&quot;</div><div class="line">            ResChunk_header.ChunkType.RES_XML_START_ELEMENT_TYPE.type -&gt; return &quot;RES_XML_START_ELEMENT_TYPE&quot;</div><div class="line">            ResChunk_header.ChunkType.RES_XML_END_ELEMENT_TYPE.type -&gt; return &quot;RES_XML_END_ELEMENT_TYPE&quot;</div><div class="line">            ResChunk_header.ChunkType.RES_XML_CDATA_TYPE.type -&gt; return &quot;RES_XML_CDATA_TYPE&quot;</div><div class="line">            ResChunk_header.ChunkType.RES_XML_LAST_CHUNK_TYPE.type -&gt; return &quot;RES_XML_LAST_CHUNK_TYPE&quot;</div><div class="line">            ResChunk_header.ChunkType.RES_XML_RESOURCE_MAP_TYPE.type -&gt; return &quot;RES_XML_RESOURCE_MAP_TYPE&quot;</div><div class="line">            ResChunk_header.ChunkType.RES_TABLE_PACKAGE_TYPE.type -&gt; return &quot;RES_TABLE_PACKAGE_TYPE&quot;</div><div class="line">            ResChunk_header.ChunkType.RES_TABLE_TYPE_TYPE.type -&gt; return &quot;RES_TABLE_TYPE_TYPE&quot;</div><div class="line">            ResChunk_header.ChunkType.RES_TABLE_TYPE_SPEC_TYPE.type -&gt; return &quot;RES_TABLE_TYPE_SPEC_TYPE&quot;</div><div class="line">        }</div><div class="line"></div><div class="line">        return &quot;&quot;</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>&#x4E0A;&#x9762;&#x7684;&#x5B9A;&#x4E49;&#x5C31;&#x662F;&#x5173;&#x4E8E;chunk&#x7684;&#x5934;&#x90E8;&#x4FE1;&#x606F;&#x7684;&#x5B9A;&#x4E49;&#xFF1A;</p>
<ul>
<li>type&#xFF1A;&#x5F53;&#x524D;&#x8FD9;&#x4E2A;chunk&#x7684;&#x7C7B;&#x578B;</li>
<li>headerSize&#xFF1A;&#x5F53;&#x524D;&#x8FD9;&#x4E2A;chunk&#x7684;&#x5934;&#x90E8;&#x5927;&#x5C0F;</li>
<li>size&#xFF1A;&#x5F53;&#x524D;&#x8FD9;&#x4E2A;chunk&#x7684;&#x5927;&#x5C0F;</li>
</ul>
</blockquote>
<hr>
<h1 id="4-package&#x6570;&#x91CF;&#x683C;&#x5F0F;"><a href="#4-package&#x6570;&#x91CF;&#x683C;&#x5F0F;" class="headerlink" title="4. package&#x6570;&#x91CF;&#x683C;&#x5F0F;"></a>4. package&#x6570;&#x91CF;&#x683C;&#x5F0F;</h1><blockquote>
<p>ResTable_header&#x662F;&#x5173;&#x4E8E;&#x8FD9;&#x4E2A;&#x683C;&#x5F0F;&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x5176;&#x5B9E;&#x91CC;&#x9762;&#x53EA;&#x6709;&#x4E00;&#x4E2A;uint32_t&#x7684;packageCount&#xFF0C;&#x7528;&#x4E8E;&#x5B58;&#x50A8;package&#x7684;&#x6570;&#x91CF;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">ResourceTypes.h&#x5B9A;&#x4E49;</div><div class="line">/**</div><div class="line"> * Header for a resource table.  Its data contains a series of</div><div class="line"> * additional chunks:</div><div class="line"> *   * A ResStringPool_header containing all table values.  This string pool</div><div class="line"> *     contains all of the string values in the entire resource table (not</div><div class="line"> *     the names of entries or type identifiers however).</div><div class="line"> *   * One or more ResTable_package chunks.</div><div class="line"> *</div><div class="line"> * Specific entries within a resource table can be uniquely identified</div><div class="line"> * with a single integer as defined by the ResTable_ref structure.</div><div class="line"> */</div><div class="line">struct ResTable_header</div><div class="line">{</div><div class="line">    struct ResChunk_header header;</div><div class="line"></div><div class="line">    // The number of ResTable_package structures.</div><div class="line">    uint32_t packageCount;</div><div class="line">};</div><div class="line">ResTable_header&#x5B9A;&#x4E49;</div><div class="line">class ResTable_header(var header: ResChunk_header, var packageCount: uint32_t) {</div><div class="line">    override fun toString(): String {</div><div class="line"></div><div class="line">        return header.toString() + &quot;, packagerCount = ${packageCount.getValue()}, packagerCountHexValue = ${packageCount.getHexValue()}&quot;</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>Android&#x4E2D;&#x4E00;&#x4E2A;apk&#x53EF;&#x80FD;&#x5305;&#x542B;&#x591A;&#x4E2A;&#x8D44;&#x6E90;&#x5305;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x90FD;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5C31;&#x662F;&#x5E94;&#x7528;&#x7684;&#x5305;&#x540D;&#x6240;&#x5728;&#x7684;&#x8D44;&#x6E90;&#x5305;</p>
<ul>
<li>packageCount&#xFF1A;&#x88AB;&#x7F16;&#x8BD1;&#x7684;&#x8D44;&#x6E90;&#x5305;&#x7684;&#x4E2A;&#x6570;<br>&#x4E0B;&#x56FE;&#x662F;&#x6211;&#x4F7F;&#x7528;&#x7684;arsc&#x6587;&#x4EF6;&#x7684;ResTable_header&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8FD9;&#x4E00;&#x90E8;&#x5206;&#x7684;TYPE&#x662F;0x0002&#xFF0C;&#x5BF9;&#x5E94;&#x4E86;RES_TABLE_TYPE&#xFF0C;&#x5E76;&#x4E14;&#x5176;headerSize&#x662F;0x000C&#xFF0C;&#x4E5F;&#x5C31;&#x662F;12&#xFF0C;&#x6574;&#x4E2A;chunk&#x7684;&#x5927;&#x5C0F;&#x662F;377904&#xFF08;0x0005C430&#xFF09;&#xFF0C;packag&#x7684;&#x6570;&#x91CF;&#x662F;1&#xFF08;0x00000001&#xFF09;<br><img src="http://upload-images.jianshu.io/upload_images/5720362-f3b58e036ddfddf2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ResTable_header"><br><img src="http://upload-images.jianshu.io/upload_images/5720362-00174d8fd407b4f2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="&#x603B;&#x5927;&#x5C0F;.png"><br>&#x8FD9;&#x4E00;&#x90E8;&#x5206;&#x603B;&#x4F53;&#x6765;&#x8BF4;&#x89E3;&#x6790;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x524D;&#x9762;&#x7684;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x5BF9;&#x5E94;&#x4E86;&#x7C7B;&#x578B;&#xFF0C;&#x63A5;&#x7740;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x5BF9;&#x5E94;&#x4E86;headerSize&#xFF0C;&#x540E;&#x9762;&#x56DB;&#x4E2A;&#x5B57;&#x8282;&#x5BF9;&#x5E94;&#x4E86;&#x6574;&#x4E2A;&#x5927;&#x5C0F;size&#xFF0C;&#x6700;&#x540E;&#x7684;&#x56DB;&#x4E2A;&#x5B57;&#x8282;&#x5BF9;&#x5E94;&#x4E86;package&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8FD9;&#x4E2A;&#x6570;&#x91CF;&#x662F;1&#x3002;</li>
</ul>
</blockquote>
<hr>
<h1 id="5-String-Pool"><a href="#5-String-Pool" class="headerlink" title="5. String Pool"></a>5. String Pool</h1><blockquote>
<p>&#x5148;&#x770B;&#x4E0B;ResourceTypes.h&#x5BF9;String Pool&#x7684;&#x5B9A;&#x4E49;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line">ResourceTypes.h&#x5B9A;&#x4E49;</div><div class="line">struct ResStringPool_header</div><div class="line">{</div><div class="line">    struct ResChunk_header header;</div><div class="line"></div><div class="line">    // Number of strings in this pool (number of uint32_t indices that follow</div><div class="line">    // in the data).</div><div class="line">    uint32_t stringCount;</div><div class="line"></div><div class="line">    // Number of style span arrays in the pool (number of uint32_t indices</div><div class="line">    // follow the string indices).</div><div class="line">    uint32_t styleCount;</div><div class="line"></div><div class="line">    // Flags.</div><div class="line">    enum {</div><div class="line">        // If set, the string index is sorted by the string values (based</div><div class="line">        // on strcmp16()).</div><div class="line">        SORTED_FLAG = 1&lt;&lt;0,</div><div class="line"></div><div class="line">        // String pool is encoded in UTF-8</div><div class="line">        UTF8_FLAG = 1&lt;&lt;8</div><div class="line">    };</div><div class="line">    uint32_t flags;</div><div class="line"></div><div class="line">    // Index from header of the string data.</div><div class="line">    uint32_t stringsStart;</div><div class="line"></div><div class="line">    // Index from header of the style data.</div><div class="line">    uint32_t stylesStart;</div><div class="line">};</div><div class="line">ResTable_header&#x5B9A;&#x4E49;</div><div class="line">class ResStringPool_header(var header: ResChunk_header,</div><div class="line">                           var stringCount: uint32_t, //&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x6570;&#x91CF;</div><div class="line">                           var styleCount: uint32_t, //&#x5B57;&#x7B26;&#x4E32;&#x6837;&#x5F0F;&#x7684;&#x6570;&#x91CF;</div><div class="line">                           var flags: uint32_t, //&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5C5E;&#x6027;,&#x53EF;&#x53D6;&#x503C;&#x5305;&#x62EC;0x000(UTF-16),0x001(&#x5B57;&#x7B26;&#x4E32;&#x7ECF;&#x8FC7;&#x6392;&#x5E8F;)&#x3001;0X100(UTF-8)&#x548C;&#x4ED6;&#x4EEC;&#x7684;&#x7EC4;&#x5408;&#x503C;</div><div class="line">                           var stringsStart: uint32_t, //&#x5B57;&#x7B26;&#x4E32;&#x5185;&#x5BB9;&#x5757;&#x76F8;&#x5BF9;&#x4E8E;&#x5176;&#x5934;&#x90E8;&#x7684;&#x8DDD;&#x79BB;</div><div class="line">                           var stylesStart: uint32_t, //&#x5B57;&#x7B26;&#x4E32;&#x6837;&#x5F0F;&#x5757;&#x76F8;&#x5BF9;&#x4E8E;&#x5176;&#x5934;&#x90E8;&#x7684;&#x8DDD;&#x79BB;</div><div class="line">                           var stringOffsetArray: ResString_offset_array?,//&#x5B57;&#x7B26;&#x4E32;&#x504F;&#x79FB;&#x6570;&#x7EC4;</div><div class="line">                           var styleOffsetArray: ResStyle_offset_array?,//&#x5B57;&#x7B26;&#x4E32;&#x6837;&#x5F0F;&#x504F;&#x79FB;&#x6570;&#x7EC4;</div><div class="line">                           var stringStringArray: ResString_string_array?,//&#x5B57;&#x7B26;&#x4E32;&#x6570;&#x7EC4;</div><div class="line">                           var styleStringArray: ResStyle_string_array?//&#x5B57;&#x7B26;&#x4E32;&#x6837;&#x5F0F;&#x6570;&#x7EC4;</div><div class="line"></div><div class="line">) {</div><div class="line">    // Flags.</div><div class="line">    enum class FLAGS(var flag: Int) {</div><div class="line">        // If set, the string index is sorted by the string values (based</div><div class="line">        // on strcmp16()).</div><div class="line">        SORTED_FLAG(1 shl 0),</div><div class="line">        // String pool is encoded in UTF-8</div><div class="line">        UTF8_FLAG(1 shl 8)</div><div class="line">    }</div><div class="line"></div><div class="line">    override fun toString(): String {</div><div class="line">        val result = &quot;&quot;&quot;$header,</div><div class="line">            |stringCount = ${stringCount.getValue()}, stringCountHexValue = ${stringCount.getHexValue()},</div><div class="line">            |styleCount = ${styleCount.getValue()}, styleCountHexValue = ${styleCount.getHexValue()},</div><div class="line">            |flags = ${flags.getValue()}, flagsHexValue = ${flags.getHexValue()},</div><div class="line">            |stringsStart = ${stringsStart.getValue()}, stringsStartCountHexValue = ${stringsStart.getHexValue()},</div><div class="line">            |stylesStart = ${stylesStart.getValue()}, stylesStartHexValue = ${stylesStart.getHexValue()},&quot;&quot;&quot;.trimMargin()</div><div class="line">        return result</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>&#x4ECE;&#x5B9A;&#x4E49;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x8FD9;&#x4E00;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#x633A;&#x591A;&#xFF1A;</p>
<ul>
<li>header&#xFF1A;&#x5934;&#x90E8;&#x4FE1;&#x606F;&#xFF0C;ResChunk_header&#x683C;&#x5F0F;</li>
<li>stringCount&#xFF1A;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x6570;&#x91CF;&#xFF0C;uint32_t&#x683C;&#x5F0F;</li>
<li>styleCount&#xFF1A;&#x5B57;&#x7B26;&#x4E32;&#x6837;&#x5F0F;&#x7684;&#x6570;&#x91CF;&#xFF0C;uint32_t&#x683C;&#x5F0F;</li>
<li>flags&#xFF1A;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5C5E;&#x6027;,&#x53EF;&#x53D6;&#x503C;&#x5305;&#x62EC;0x000(UTF-16),0x001(&#x5B57;&#x7B26;&#x4E32;&#x7ECF;&#x8FC7;&#x6392;&#x5E8F;)&#x3001;0X100(UTF-8)&#x548C;&#x4ED6;&#x4EEC;&#x7684;&#x7EC4;&#x5408;&#x503C;&#xFF0C;uint32_t&#x683C;&#x5F0F;</li>
<li>stringsStart&#xFF1A;&#x5B57;&#x7B26;&#x4E32;&#x5F00;&#x59CB;&#x4F4D;&#x7F6E;&#xFF0C;&#x76F8;&#x5BF9;&#x4E8E;&#x5934;&#x90E8;&#xFF0C;uint32_t&#x683C;&#x5F0F;</li>
<li>stylesStart&#xFF1A;&#x5B57;&#x7B26;&#x4E32;&#x6837;&#x5F0F;&#x5F00;&#x59CB;&#x4F4D;&#x7F6E;&#xFF0C;&#x76F8;&#x5BF9;&#x4E8E;&#x5934;&#x90E8;&#xFF0C;uint32_t&#x683C;&#x5F0F;</li>
<li>&#x56DB;&#x4E2A;&#x6570;&#x7EC4;&#xFF1A;&#x81EA;&#x5DF1;&#x5B9A;&#x4E49;&#xFF0C;&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x504F;&#x79FB;&#x91CF;&#x4EE5;&#x53CA;string&#x7684;&#x503C;<br>&#x4E0B;&#x56FE;&#x662F;&#x6211;&#x4F7F;&#x7528;&#x7684;arsc&#x6587;&#x4EF6;&#x7684;ResStringPool_header&#x4FE1;&#x606F;&#xFF08;&#x4E0D;&#x5305;&#x62EC;&#x6570;&#x7EC4;&#x5185;&#x5BB9;&#xFF09;&#xFF1A;<br><img src="http://upload-images.jianshu.io/upload_images/5720362-8828d523ff23bbfe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="StringPool&#x5934;&#x90E8;&#x4FE1;&#x606F;.png"><br>&#x4ECE;&#x56FE;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF1A;</li>
</ul>
<ol>
<li>headerSize&#x662F;28&#xFF08;0x001c&#xFF09;</li>
<li>size&#x662F;142676&#xFF08;0x00022d54&#xFF09;</li>
<li>stringCount&#x662F;2882&#xFF08;0x00000b42&#xFF09;</li>
<li>styleCount&#x662F;1&#xFF08;0x00000001&#xFF09;</li>
<li>flags&#x662F;256&#xFF08;0x00000100&#xFF09;&#x4EE3;&#x8868;&#x4E86;&#x7F16;&#x7801;&#x662F;UTF-8</li>
<li>stringsStart&#x662F;11560&#xFF08;0x00002d28&#xFF09;</li>
<li>stylesStart&#x662F;142652&#xFF08;0x00022d3c&#xFF09;<br>&#x4E0A;&#x9762;&#x7684;&#x4FE1;&#x606F;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x63A5;&#x7740;&#x4FBF;&#x662F;&#x4E24;&#x4E2A;&#x504F;&#x79FB;&#x6570;&#x7EC4;&#xFF08;&#x5B57;&#x7B26;&#x4E32;&#x504F;&#x79FB;&#x6570;&#x7EC4;&#x548C;&#x5B57;&#x7B26;&#x4E32;&#x6837;&#x5F0F;&#x504F;&#x79FB;&#x6570;&#x7EC4;&#xFF09;&#xFF0C;&#x504F;&#x79FB;&#x6570;&#x7EC4;&#x7ED3;&#x675F;&#x540E;&#x5C31;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x3002;&#x5B57;&#x7B26;&#x4E32;&#x8D44;&#x6E90;&#x6C60;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x524D;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;,&#x957F;&#x5EA6;&#x8BA1;&#x7B97;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#x3002;&#x53E6;&#x5916;&#x5982;&#x679C;&#x5B57;&#x7B26;&#x4E32;&#x7F16;&#x7801;&#x683C;&#x5F0F;&#x4E3A;UTF-8&#x5219;&#x5B57;&#x7B26;&#x4E32;&#x4EE5;0X00&#x4F5C;&#x4E3A;&#x7ED3;&#x675F;&#x7B26;&#xFF0C;UTF-16&#x5219;&#x4EE5;0X0000&#x4F5C;&#x4E3A;&#x7ED3;&#x675F;&#x7B26;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x9ED8;&#x8BA4;&#x8BA4;&#x4E3A;&#x662F;UTF-8&#x7F16;&#x7801;&#xFF0C;&#x89E3;&#x6790;&#x8FC7;&#x7A0B;&#x5B8C;&#x5168;&#x6309;&#x7167;UTF-8&#x7F16;&#x7801;&#x6765;&#x89E3;&#x6790;&#x3002;&#x5728;&#x957F;&#x5EA6;&#x8BA1;&#x7B97;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x53D1;&#x73B0;&#x7F51;&#x4E0A;&#x5F88;&#x591A;&#x4EBA;&#x5199;&#x7684;&#x90FD;&#x4E0D;&#x662F;&#x5F88;&#x5BF9;&#xFF0C;&#x8D77;&#x7801;&#x5F53;&#x957F;&#x5EA6;&#x8D85;&#x8FC7;128&#xFF08;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#xFF09;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x4F1A;&#x6709;&#x95EE;&#x9898;&#xFF0C;&#x8FD9;&#x4E2A;&#x957F;&#x5EA6;&#x8BA1;&#x7B97;&#x53EF;&#x662F;&#x8D39;&#x4E86;&#x597D;&#x591A;&#x8111;&#x5B50;&#xFF0C;&#x5199;&#x5199;&#x753B;&#x753B;&#x597D;&#x51E0;&#x5929;&#xFF0C;&#x7EC8;&#x4E8E;&#x5F04;&#x51FA;&#x4E00;&#x4E2A;&#x6211;&#x8BA4;&#x4E3A;&#x662F;&#x6B63;&#x786E;&#x7684;&#x8BA1;&#x7B97;&#x65B9;&#x6CD5;&#xFF08;&#x6211;&#x4E0D;&#x4FDD;&#x8BC1;&#x6B63;&#x786E;&#xFF0C;&#x4F46;&#x81F3;&#x5C11;&#x6211;&#x89E3;&#x6790;&#x7684;&#x8FC7;&#x7A0B;&#x662F;&#x6B63;&#x786E;&#x7684;&#xFF0C;&#x59D1;&#x4E14;&#x8BA4;&#x4E3A;&#x662F;&#x5BF9;&#x7684;&#x5427;&#xFF09;:<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var i = 0</div><div class="line">    while (realSize and (0x80 shl i) != 0) {</div><div class="line">        c++</div><div class="line">        byteArray[0] = stream[index + c]</div><div class="line">        realSize = ((realSize and 0x7f) shl 8) or (byteArray[0].toInt() and 0xff)</div><div class="line">        i += 4</div><div class="line">    }</div></pre></td></tr></table></figure>
</li>
</ol>
</blockquote>
<hr>
<h1 id="6-Package&#x4FE1;&#x606F;"><a href="#6-Package&#x4FE1;&#x606F;" class="headerlink" title="6. Package&#x4FE1;&#x606F;"></a>6. Package&#x4FE1;&#x606F;</h1><blockquote>
<p>&#x7EE7;String Pool&#x4FE1;&#x606F;&#x4E4B;&#x540E;&#xFF0C;&#x5C31;&#x662F;Package&#x4FE1;&#x606F;&#x5757;&#x3002;&#x5176;&#x5B9A;&#x4E49;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line">ResourceTypes.h&#x5B9A;&#x4E49;</div><div class="line">struct ResTable_package</div><div class="line">{</div><div class="line">    struct ResChunk_header header;</div><div class="line"></div><div class="line">    // If this is a base package, its ID.  Package IDs start</div><div class="line">    // at 1 (corresponding to the value of the package bits in a</div><div class="line">    // resource identifier).  0 means this is not a base package.</div><div class="line">    uint32_t id;</div><div class="line"></div><div class="line">    // Actual name of this package, \0-terminated.</div><div class="line">    uint16_t name[128];</div><div class="line"></div><div class="line">    // Offset to a ResStringPool_header defining the resource</div><div class="line">    // type symbol table.  If zero, this package is inheriting from</div><div class="line">    // another base package (overriding specific values in it).</div><div class="line">    uint32_t typeStrings;</div><div class="line"></div><div class="line">    // Last index into typeStrings that is for public use by others.</div><div class="line">    uint32_t lastPublicType;</div><div class="line"></div><div class="line">    // Offset to a ResStringPool_header defining the resource</div><div class="line">    // key symbol table.  If zero, this package is inheriting from</div><div class="line">    // another base package (overriding specific values in it).</div><div class="line">    uint32_t keyStrings;</div><div class="line"></div><div class="line">    // Last index into keyStrings that is for public use by others.</div><div class="line">    uint32_t lastPublicKey;</div><div class="line"></div><div class="line">    uint32_t typeIdOffset;</div><div class="line">};</div><div class="line">ResTable_package&#x5B9A;&#x4E49;</div><div class="line">class ResTable_package(</div><div class="line">        var header: ResChunk_header,</div><div class="line">        // If this is a base package, its ID.  Package IDs start</div><div class="line">        // at 1 (corresponding to the value of the package bits in a</div><div class="line">        // resource identifier).  0 means this is not a base package.</div><div class="line">        var id: uint32_t,</div><div class="line">        // Actual name of this package, \0-terminated.</div><div class="line">        var name: String,</div><div class="line">        // Offset to a ResStringPool_header defining the resource</div><div class="line">        // type symbol table.  If zero, this package is inheriting from</div><div class="line">        // another base package (overriding specific values in it).</div><div class="line">        var typeStrings: uint32_t,</div><div class="line">        // Last index into typeStrings that is for public use by others.</div><div class="line">        var lastPublicType: uint32_t,</div><div class="line">        // Offset to a ResStringPool_header defining the resource</div><div class="line">        // key symbol table.  If zero, this package is inheriting from</div><div class="line">        // another base package (overriding specific values in it).</div><div class="line">        var keyStrings: uint32_t,</div><div class="line">        // Last index into keyStrings that is for public use by others.</div><div class="line">        var lastPublicKey: uint32_t) {</div><div class="line"></div><div class="line">    override fun toString(): String {</div><div class="line">        val result = &quot;&quot;&quot;$header,</div><div class="line">                    |id = ${id.getValue()}, idHexValue = ${id.getHexValue()}</div><div class="line">                    |name = $name</div><div class="line">                    |typeStrings = ${typeStrings.getValue()}, typeStringsHexValue = ${typeStrings.getHexValue()}</div><div class="line">                    |lastPublicType = ${lastPublicType.getValue()}, lastPublicTypeHexValue = ${lastPublicType.getHexValue()}</div><div class="line">                    |keyStrings = ${keyStrings.getValue()}, keyStringsHexValue = ${keyStrings.getHexValue()}</div><div class="line">                    |lastPublicKey = ${lastPublicKey.getValue()}, lastPublicKeyHexValue = ${lastPublicKey.getHexValue()}&quot;&quot;&quot;.trimMargin()</div><div class="line"></div><div class="line">        return result</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>&#x6BCF;&#x4E2A;&#x5B57;&#x6BB5;&#x5BF9;&#x5E94;&#x7684;&#x542B;&#x4E49;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li>header&#xFF1A;Chunk&#x7684;&#x5934;&#x90E8;&#x4FE1;&#x606F;&#x6570;&#x636E;&#x7ED3;&#x6784;</li>
<li>id&#xFF1A;&#x5305;&#x7684;ID&#xFF0C;&#x7B49;&#x4E8E;Package Id,&#x4E00;&#x822C;&#x7528;&#x6237;&#x5305;&#x7684;&#x503C;Package Id&#x4E3A;0X7F&#xFF0C;&#x7CFB;&#x7EDF;&#x8D44;&#x6E90;&#x5305;&#x7684;Package Id&#x4E3A;0X01&#xFF0C;uint32_t&#x683C;&#x5F0F;</li>
<li>name&#xFF1A;&#x5305;&#x540D;&#xFF0C;String&#xFF0C;256&#x5B57;&#x8282;</li>
<li>typeString&#xFF1A;&#x7C7B;&#x578B;&#x5B57;&#x7B26;&#x4E32;&#x8D44;&#x6E90;&#x6C60;&#x76F8;&#x5BF9;&#x5934;&#x90E8;&#x7684;&#x504F;&#x79FB;&#xFF0C;uint32_t&#x683C;&#x5F0F;</li>
<li>lastPublicType&#xFF1A;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5BFC;&#x51FA;&#x7684;Public&#x7C7B;&#x578B;&#x5B57;&#x7B26;&#x4E32;&#x5728;&#x7C7B;&#x578B;&#x5B57;&#x7B26;&#x4E32;&#x8D44;&#x6E90;&#x6C60;&#x4E2D;&#x7684;&#x7D22;&#x5F15;&#xFF0C;uint32_t&#x683C;&#x5F0F;</li>
<li>keyStrings&#xFF1A;&#x8D44;&#x6E90;&#x9879;&#x540D;&#x79F0;&#x5B57;&#x7B26;&#x4E32;&#x76F8;&#x5BF9;&#x5934;&#x90E8;&#x7684;&#x504F;&#x79FB;&#xFF0C;uint32_t&#x683C;&#x5F0F;</li>
<li>lastPublicKey&#xFF1A;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5BFC;&#x51FA;&#x7684;Public&#x8D44;&#x6E90;&#x9879;&#x540D;&#x79F0;&#x5B57;&#x7B26;&#x4E32;&#x5728;&#x8D44;&#x6E90;&#x9879;&#x540D;&#x79F0;&#x5B57;&#x7B26;&#x4E32;&#x8D44;&#x6E90;&#x6C60;&#x4E2D;&#x7684;&#x7D22;&#x5F15;&#xFF0C;uint32_t&#x683C;&#x5F0F;<br>&#x793A;&#x4F8B;&#x5982;&#x4E0B;&#x56FE;&#xFF1A;<br><img src="http://upload-images.jianshu.io/upload_images/5720362-bb8832785c808c9f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Package&#x4FE1;&#x606F;.png"><br>&#x4ECE;&#x56FE;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF1A;</li>
</ul>
<ol>
<li>headerSize = 288&#xFF08;0x0120&#xFF09;</li>
<li>size = 235216&#xFF08; 0x000396d0&#xFF09;</li>
<li>id = 127&#xFF08; 0x0000007f&#xFF09;</li>
<li>name = c o m . n i c k . m y a p p l i c a t i o n                                                                                                                                                                                                                     </li>
<li>typeStrings = 288&#xFF08;0x00000120&#xFF09;</li>
<li>lastPublicType = 13&#xFF08;0x0000000d&#xFF09;</li>
<li>keyStrings = 480&#xFF08;0x000001e0&#xFF09;</li>
<li>lastPublicKey = 1472&#xFF08;0x000005c0&#xFF09;</li>
</ol>
</blockquote>
<hr>
<h1 id="7-&#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x548C;&#x8D44;&#x6E90;&#x9879;&#x540D;&#x79F0;&#x5B57;&#x7B26;&#x4E32;&#x6C60;"><a href="#7-&#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x548C;&#x8D44;&#x6E90;&#x9879;&#x540D;&#x79F0;&#x5B57;&#x7B26;&#x4E32;&#x6C60;" class="headerlink" title="7. &#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x548C;&#x8D44;&#x6E90;&#x9879;&#x540D;&#x79F0;&#x5B57;&#x7B26;&#x4E32;&#x6C60;"></a>7. &#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x548C;&#x8D44;&#x6E90;&#x9879;&#x540D;&#x79F0;&#x5B57;&#x7B26;&#x4E32;&#x6C60;</h1><blockquote>
<p>&#x8FD9;&#x4E00;&#x90E8;&#x5206;&#x662F;&#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x548C;&#x8D44;&#x6E90;&#x9879;&#x540D;&#x79F0;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;Android&#x91CC;&#x9762;&#x7684;attr&#x3001;drawable&#x3001;layout&#x7B49;&#x6587;&#x4EF6;&#xFF0C;&#x5176;&#x683C;&#x5F0F;&#x662F;ResStringPool_header&#x683C;&#x5F0F;&#xFF0C;&#x8FD9;&#x91CC;&#x4E0D;&#x591A;&#x8D58;&#x8FF0;&#x3002;&#x67E5;&#x627E;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x4F4D;&#x7F6E;&#x6BD4;&#x8F83;&#x597D;&#x627E;&#xFF0C;&#x901A;&#x8FC7;&#x67E5;&#x627E;attr&#x5C31;&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x5927;&#x6982;&#x4F4D;&#x7F6E;&#x3002;</p>
</blockquote>
<hr>
<h1 id="8-&#x7C7B;&#x578B;&#x89C4;&#x8303;&#x6570;&#x636E;&#x5757;"><a href="#8-&#x7C7B;&#x578B;&#x89C4;&#x8303;&#x6570;&#x636E;&#x5757;" class="headerlink" title="8. &#x7C7B;&#x578B;&#x89C4;&#x8303;&#x6570;&#x636E;&#x5757;"></a>8. &#x7C7B;&#x578B;&#x89C4;&#x8303;&#x6570;&#x636E;&#x5757;</h1><blockquote>
<p>&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;&#x7684;&#x8D44;&#x6E90;&#x89C4;&#x8303;&#xFF0C;&#x6BCF;&#x79CD;&#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x5E94;&#x8BE5;&#x6709;&#x4E00;&#x4E2A;&#x8FD9;&#x6837;&#x7684;&#x5757;&#x3002;&#x8BE5;&#x7ED3;&#x6784;&#x4E4B;&#x540E;&#x662F;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x6570;&#x7EC4;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x7EC4;&#x914D;&#x7F6E;&#x66F4;&#x6539;&#x6807;&#x5FD7;&#xFF08;ResTable<em>config :: CONFIG</em> *&#xFF09;&#xFF0C;&#x8BE5;&#x6807;&#x5FD7;&#x5177;&#x6709;&#x8BE5;&#x914D;&#x7F6E;&#x7684;&#x591A;&#x4E2A;&#x8D44;&#x6E90;&#x3002; &#x53E6;&#x5916;&#xFF0C;&#x5982;&#x679C;&#x8BE5;&#x8D44;&#x6E90;&#x5DF2;&#x88AB;&#x516C;&#x5F00;&#xFF0C;&#x5219;&#x9AD8;&#x4F4D;&#x88AB;&#x8BBE;&#x7F6E;&#x3002;&#x5176;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">ResourceTypes.h&#x5B9A;&#x4E49;</div><div class="line">struct ResTable_typeSpec</div><div class="line">{</div><div class="line">    struct ResChunk_header header;</div><div class="line"></div><div class="line">    // The type identifier this chunk is holding.  Type IDs start</div><div class="line">    // at 1 (corresponding to the value of the type bits in a</div><div class="line">    // resource identifier).  0 is invalid.</div><div class="line">    uint8_t id;</div><div class="line">    </div><div class="line">    // Must be 0.</div><div class="line">    uint8_t res0;</div><div class="line">    // Must be 0.</div><div class="line">    uint16_t res1;</div><div class="line">    </div><div class="line">    // Number of uint32_t entry configuration masks that follow.</div><div class="line">    uint32_t entryCount;</div><div class="line"></div><div class="line">    enum {</div><div class="line">        // Additional flag indicating an entry is public.</div><div class="line">        SPEC_PUBLIC = 0x40000000</div><div class="line">    };</div><div class="line">};</div><div class="line">ResTable_typeSpec</div><div class="line">class ResTable_typeSpec(var header: ResChunk_header,</div><div class="line">                        var id: uint8_t,// id&#xFF0C;&#x6BCF;&#x4E2A;&#x8D44;&#x6E90;&#x72EC;&#x6709;&#x7684;id</div><div class="line">                        var res0: uint8_t,// &#x4FDD;&#x7559;&#x5B57;&#x6BB5;&#xFF0C;&#x4E3A;0</div><div class="line">                        var res1: uint16_t, // &#x4FDD;&#x7559;&#x5B57;&#x6BB5;&#xFF0C;&#x4E3A;0</div><div class="line">                        var entryCount: uint32_t) {// &#x8D44;&#x6E90;&#x9879;&#x4E2A;&#x6570;</div><div class="line"></div><div class="line">    override fun toString(): String {</div><div class="line">        return &quot;&quot;&quot;header = $header ,</div><div class="line">                |id = ${id.getValue()}, idHexValue = ${id.getHexValue()},</div><div class="line">                |res0 =${res0.getValue()} ,res1 = ${res1.getValue()} ,</div><div class="line">                |entryCount = ${entryCount.getValue()}, entryCountHexValue = ${entryCount.getHexValue()}&quot;&quot;&quot;.trimMargin()</div><div class="line">    }</div><div class="line"></div><div class="line">    companion object {</div><div class="line">        val SPEC_PUBLIC = 0x40000000</div><div class="line">    }</div><div class="line"></div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>&#x6BCF;&#x4E2A;&#x5B57;&#x6BB5;&#x5BF9;&#x5E94;&#x7684;&#x542B;&#x4E49;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li>header&#xFF1A;Chunk&#x7684;&#x5934;&#x90E8;&#x4FE1;&#x606F;&#x6570;&#x636E;&#x7ED3;&#x6784;</li>
<li>id&#xFF1A;&#x6BCF;&#x4E2A;&#x8D44;&#x6E90;&#x72EC;&#x6709;&#x7684;id&#xFF0C;uint8_t&#x7ED3;&#x6784;</li>
<li>res0&#x548C;res1&#xFF1A;&#x4FDD;&#x7559;&#x5B57;&#x6BB5;&#xFF0C;&#x90FD;&#x4E3A;0&#xFF0C;uint8_t&#x548C;uint16_t&#x7ED3;&#x6784;</li>
<li>entryCount&#xFF1A;&#x5F53;&#x524D;&#x7C7B;&#x578B;&#x7684;&#x8D44;&#x6E90;&#x9879;&#x7684;&#x4E2A;&#x6570;&#xFF0C;uint32_t&#x7ED3;&#x6784;<br>&#x793A;&#x4F8B;&#x5982;&#x4E0B;&#x56FE;&#xFF1A;<br><img src="http://upload-images.jianshu.io/upload_images/5720362-133b6cfaffa28b86.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ResTable_typeSpec.png"><br>&#x5176;&#x8868;&#x793A;&#x7684;&#x4FE1;&#x606F;&#x4E3A;&#xFF1A;</li>
</ul>
<ol>
<li>type = RES_TABLE_TYPE_SPEC_TYPE&#xFF08;0x0202&#xFF09;</li>
<li>headerSize = 16&#xFF08;0x0010&#xFF09;</li>
<li>size = 1472&#xFF08;0x000005c0 &#xFF09;</li>
<li>id = 1&#xFF08;0x01&#xFF09;</li>
<li>res0 =0&#xFF0C;res1 = 0</li>
<li>entryCount = 364&#xFF08;0x0000016c&#xFF09;</li>
<li>id&#x5BF9;&#x5E94;&#x7684;&#x8D44;&#x6E90;&#x9879;&#x503C;attr</li>
</ol>
</blockquote>
<hr>
<h1 id="9-&#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x9879;&#x6570;&#x636E;&#x5757;"><a href="#9-&#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x9879;&#x6570;&#x636E;&#x5757;" class="headerlink" title="9. &#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x9879;&#x6570;&#x636E;&#x5757;"></a>9. &#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x9879;&#x6570;&#x636E;&#x5757;</h1><blockquote>
<p>&#x8FD9;&#x4E00;&#x90E8;&#x5206;&#x6211;&#x7684;&#x7406;&#x89E3;&#x5C31;&#x662F;attr&#x3001;drawable&#x7B49;&#x6587;&#x4EF6;&#x7684;&#x5177;&#x4F53;&#x9879;&#xFF0C;&#x6BCF;&#x4E2A;&#x8D44;&#x6E90;&#x9879;&#x90FD;&#x5BF9;&#x5E94;&#x4E86;&#x591A;&#x4E2A;&#x503C;&#xFF0C;&#x8FD9;&#x4E9B;&#x503C;&#x5728;&#x4E4B;&#x524D;&#x89E3;&#x6790;&#x4E2D;&#x5DF2;&#x7ECF;&#x51FA;&#x73B0;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x901A;&#x8FC7;&#x4F4D;&#x7F6E;&#x6765;&#x786E;&#x5B9A;&#x5177;&#x4F53;&#x503C;&#x3002;&#x8FD9;&#x8FB9;&#x7684;&#x7ED3;&#x6784;&#x6709;&#x70B9;&#x591A;&#xFF0C;&#x8FD9;&#x91CC;&#x8FD8;&#x662F;&#x53EA;&#x5C55;&#x793A;&#x4E00;&#x90E8;&#x5206;&#x5427;&#xFF0C;&#x771F;&#x5FC3;&#x6709;&#x70B9;&#x591A;&#x3002;&#x5177;&#x4F53;&#x5B9A;&#x4E49;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div></pre></td><td class="code"><pre><div class="line">ResourceTypes.h&#x5B9A;&#x4E49;&#xFF1A;</div><div class="line">struct ResTable_type</div><div class="line">{</div><div class="line">    struct ResChunk_header header;</div><div class="line"></div><div class="line">    enum {</div><div class="line">        NO_ENTRY = 0xFFFFFFFF</div><div class="line">    };</div><div class="line">    </div><div class="line">    // The type identifier this chunk is holding.  Type IDs start</div><div class="line">    // at 1 (corresponding to the value of the type bits in a</div><div class="line">    // resource identifier).  0 is invalid.</div><div class="line">    uint8_t id;</div><div class="line">    </div><div class="line">    // Must be 0.</div><div class="line">    uint8_t res0;</div><div class="line">    // Must be 0.</div><div class="line">    uint16_t res1;</div><div class="line">    </div><div class="line">    // Number of uint32_t entry indices that follow.</div><div class="line">    uint32_t entryCount;</div><div class="line"></div><div class="line">    // Offset from header where ResTable_entry data starts.</div><div class="line">    uint32_t entriesStart;</div><div class="line">    </div><div class="line">    // Configuration this collection of entries is designed for.</div><div class="line">    //&#x8FD9;&#x4E2A;&#x4E0D;&#x5C55;&#x5F00;&#x4E86;&#xFF0C;&#x5185;&#x5BB9;&#x6709;&#x70B9;&#x591A;</div><div class="line">    ResTable_config config; </div><div class="line">};</div><div class="line">// entry</div><div class="line">struct ResTable_entry</div><div class="line">{</div><div class="line">    // Number of bytes in this structure.</div><div class="line">    uint16_t size;</div><div class="line"></div><div class="line">    enum {</div><div class="line">        // If set, this is a complex entry, holding a set of name/value</div><div class="line">        // mappings.  It is followed by an array of ResTable_map structures.</div><div class="line">        FLAG_COMPLEX = 0x0001,</div><div class="line">        // If set, this resource has been declared public, so libraries</div><div class="line">        // are allowed to reference it.</div><div class="line">        FLAG_PUBLIC = 0x0002</div><div class="line">    };</div><div class="line">    uint16_t flags;</div><div class="line">    </div><div class="line">    // Reference into ResTable_package::keyStrings identifying this entry.</div><div class="line">    struct ResStringPool_ref key;</div><div class="line">};</div><div class="line">// map entry</div><div class="line">struct ResTable_map_entry : public ResTable_entry</div><div class="line">{</div><div class="line">    // Resource identifier of the parent mapping, or 0 if there is none.</div><div class="line">    // This is always treated as a TYPE_DYNAMIC_REFERENCE.</div><div class="line">    ResTable_ref parent;</div><div class="line">    // Number of name/value pairs that follow for FLAG_COMPLEX.</div><div class="line">    uint32_t count;</div><div class="line">};</div><div class="line">// map</div><div class="line">struct ResTable_map</div><div class="line">{</div><div class="line">    // The resource identifier defining this mapping&apos;s name.  For attribute</div><div class="line">    // resources, &apos;name&apos; can be one of the following special resource types</div><div class="line">    // to supply meta-data about the attribute; for all other resource types</div><div class="line">    // it must be an attribute resource.</div><div class="line">    ResTable_ref name;</div><div class="line">    ......</div><div class="line">    // This mapping&apos;s value.</div><div class="line">    Res_value value;</div><div class="line">};</div><div class="line">// &#x771F;&#x6B63;&#x7684;value</div><div class="line">struct Res_value</div><div class="line">{</div><div class="line">    // Number of bytes in this structure.</div><div class="line">    uint16_t size;</div><div class="line">    // Always set to 0.</div><div class="line">    uint8_t res0;</div><div class="line">    // Type of the data value.</div><div class="line">    enum {</div><div class="line">        // The &apos;data&apos; is either 0 or 1, specifying this resource is either</div><div class="line">        // undefined or empty, respectively.</div><div class="line">        TYPE_NULL = 0x00,</div><div class="line">        // The &apos;data&apos; holds a ResTable_ref, a reference to another resource</div><div class="line">        // table entry.</div><div class="line">        TYPE_REFERENCE = 0x01,</div><div class="line">        // The &apos;data&apos; holds an attribute resource identifier.</div><div class="line">        TYPE_ATTRIBUTE = 0x02,</div><div class="line">        // The &apos;data&apos; holds an index into the containing resource table&apos;s</div><div class="line">        // global value string pool.</div><div class="line">        TYPE_STRING = 0x03,</div><div class="line">        // The &apos;data&apos; holds a single-precision floating point number.</div><div class="line">        TYPE_FLOAT = 0x04,</div><div class="line">        // The &apos;data&apos; holds a complex number encoding a dimension value,</div><div class="line">        // such as &quot;100in&quot;.</div><div class="line">        TYPE_DIMENSION = 0x05,</div><div class="line">        // The &apos;data&apos; holds a complex number encoding a fraction of a</div><div class="line">        // container.</div><div class="line">        TYPE_FRACTION = 0x06,</div><div class="line">        // The &apos;data&apos; holds a dynamic ResTable_ref, which needs to be</div><div class="line">        // resolved before it can be used like a TYPE_REFERENCE.</div><div class="line">        TYPE_DYNAMIC_REFERENCE = 0x07,</div><div class="line"></div><div class="line">        // Beginning of integer flavors...</div><div class="line">        TYPE_FIRST_INT = 0x10,</div><div class="line"></div><div class="line">        // The &apos;data&apos; is a raw integer value of the form n..n.</div><div class="line">        TYPE_INT_DEC = 0x10,</div><div class="line">        // The &apos;data&apos; is a raw integer value of the form 0xn..n.</div><div class="line">        TYPE_INT_HEX = 0x11,</div><div class="line">        // The &apos;data&apos; is either 0 or 1, for input &quot;false&quot; or &quot;true&quot; respectively.</div><div class="line">        TYPE_INT_BOOLEAN = 0x12,</div><div class="line"></div><div class="line">        // Beginning of color integer flavors...</div><div class="line">        TYPE_FIRST_COLOR_INT = 0x1c,</div><div class="line"></div><div class="line">        // The &apos;data&apos; is a raw integer value of the form #aarrggbb.</div><div class="line">        TYPE_INT_COLOR_ARGB8 = 0x1c,</div><div class="line">        // The &apos;data&apos; is a raw integer value of the form #rrggbb.</div><div class="line">        TYPE_INT_COLOR_RGB8 = 0x1d,</div><div class="line">        // The &apos;data&apos; is a raw integer value of the form #argb.</div><div class="line">        TYPE_INT_COLOR_ARGB4 = 0x1e,</div><div class="line">        // The &apos;data&apos; is a raw integer value of the form #rgb.</div><div class="line">        TYPE_INT_COLOR_RGB4 = 0x1f,</div><div class="line"></div><div class="line">        // ...end of integer flavors.</div><div class="line">        TYPE_LAST_COLOR_INT = 0x1f,</div><div class="line"></div><div class="line">        // ...end of integer flavors.</div><div class="line">        TYPE_LAST_INT = 0x1f</div><div class="line">    };</div><div class="line">    uint8_t dataType;</div><div class="line">    ......</div><div class="line">    // The data for this item, as interpreted according to dataType.</div><div class="line">    uint32_t data;</div><div class="line">};</div><div class="line">&#x4EE3;&#x7801;&#x4E2D;&#x5B9A;&#x4E49;&#xFF1A;</div><div class="line">class ResTable_type(var header: ResChunk_header,</div><div class="line">                    var id: uint8_t,// &#x6807;&#x8BC6;&#x8D44;&#x6E90;&#x7684;type id</div><div class="line">                    var res0: uint8_t,// &#x4FDD;&#x7559;&#xFF0C;0</div><div class="line">                    var res1: uint16_t,// &#x4FDD;&#x7559;&#xFF0C;0</div><div class="line">                    var entryCount: uint32_t,// &#x603B;&#x4E2A;&#x6570;</div><div class="line">                    var entriesStart: uint32_t,// &#x504F;&#x79FB;&#x91CF;</div><div class="line">                    var resConfig: ResTable_config) {// &#x914D;&#x7F6E;&#x4FE1;&#x606F;</div><div class="line"></div><div class="line">    override fun toString(): String {</div><div class="line">        return &quot;&quot;&quot;header: $header ,</div><div class="line">                |id = ${id.getValue()}, idHexValue = ${id.getHexValue()},</div><div class="line">                |res0 = ${res0.getValue()},res1 = ${res1.getValue()},</div><div class="line">                |entryCount = ${entryCount.getValue()}, entryCountHexValue = ${entryCount.getHexValue()},</div><div class="line">                |entriesStart = ${entriesStart.getValue()}, entriesStartHexValue = ${entriesStart.getHexValue()}</div><div class="line">                |resConfig = $resConfig&quot;&quot;&quot;.trimMargin()</div><div class="line">    }</div><div class="line"></div><div class="line">    companion object {</div><div class="line">        val NO_ENTRY = 0xFFFFFFFF.toInt()</div><div class="line">    }</div><div class="line"></div><div class="line">}</div><div class="line">open class ResTable_entry(var size: uint16_t,// &#x5927;&#x5C0F;</div><div class="line">                          var flags: uint16_t,// flag&#xFF0C;&#x4E3A;1&#x662F;ResTable_map_entry</div><div class="line">                          var key: ResStringPool_ref?) {// &#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x5F15;&#x7528;&#x4FE1;&#x606F;</div><div class="line">    var dataStr: String? = &quot;&quot;</div><div class="line">    override fun toString(): String {</div><div class="line">        return &quot;size = &quot; + size.getValue() + &quot;,flags = &quot; + flags.getValue() + &quot;,key = &quot; + key!!.index.getValue() + &quot;,str = &quot; + dataStr</div><div class="line">    }</div><div class="line"></div><div class="line">    companion object {</div><div class="line">        val FLAG_COMPLEX = 0x0001</div><div class="line">        val FLAG_PUBLIC = 0x0002</div><div class="line">    }</div><div class="line"></div><div class="line">}</div><div class="line">class ResTable_map_entry(size: uint16_t, flags: uint16_t, key: ResStringPool_ref?,</div><div class="line">                         var parent: ResTable_ref, // &#x6307;&#x5411;&#x7236;ResTable_map_entry&#x7684;&#x8D44;&#x6E90;ID&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x7236;ResTable_map_entry&#xFF0C;&#x5219;&#x7B49;&#x4E8E;0</div><div class="line">                         var count: uint32_t // ResTable_map&#x7684;&#x6570;&#x91CF;</div><div class="line">) : ResTable_entry(size, flags, key) {</div><div class="line"></div><div class="line">    override fun toString(): String {</div><div class="line">        return super.toString() + &quot;parent:&quot; + parent.toString() + &quot;,count:&quot; + count.getValue()</div><div class="line">    }</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line">// bag&#x8D44;&#x6E90;&#xFF1A;&#x901A;&#x4FD7;&#x7684;&#x8BF4;&#xFF0C;&#x5C31;&#x662F;&#x8FD9;&#x7C7B;&#x8D44;&#x6E90;&#x5728;&#x8D4B;&#x503C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E0D;&#x80FD;&#x968F;&#x4FBF;&#x8D4B;&#x503C;&#xFF0C;&#x53EA;&#x80FD;&#x4ECE;&#x4E8B;&#x5148;&#x5B9A;&#x4E49;&#x597D;&#x7684;&#x503C;&#x4E2D;&#x9009;&#x53D6;&#x4E00;&#x4E2A;&#x8D4B;&#x503C;&#x3002;</div><div class="line">// &#x7C7B;&#x578B;&#x4E3A;values&#x7684;&#x8D44;&#x6E90;&#x9664;&#x4E86;&#x662F;string&#x4E4B;&#x5916;&#xFF0C;&#x8FD8;&#x6709;&#x5176;&#x5B83;&#x5F88;&#x591A;&#x7C7B;&#x578B;&#x7684;&#x8D44;&#x6E90;&#xFF0C;&#x5176;&#x4E2D;&#x6709;&#x4E00;&#x4E9B;&#x6BD4;&#x8F83;&#x7279;&#x6B8A;&#xFF0C;&#x5982;bag&#x3001;style&#x3001;plurals&#x548C;array&#x7C7B;&#x7684;&#x8D44;&#x6E90;&#x3002;</div><div class="line">// &#x8FD9;&#x4E9B;&#x8D44;&#x6E90;&#x4F1A;&#x7ED9;&#x81EA;&#x5DF1;&#x5B9A;&#x4E49;&#x4E00;&#x4E9B;&#x4E13;&#x7528;&#x7684;&#x503C;&#xFF0C;&#x8FD9;&#x4E9B;&#x5E26;&#x6709;&#x4E13;&#x7528;&#x503C;&#x7684;&#x8D44;&#x6E90;&#x5C31;&#x7EDF;&#x79F0;&#x4E3A;Bag&#x8D44;&#x6E90;&#x3002;</div><div class="line">class ResTable_map(var name: ResTable_ref, // bag&#x8D44;&#x6E90;&#x9879;ID,</div><div class="line">                   var value: Res_value) { //bag&#x8D44;&#x6E90;&#x9879;&#x503C;</div><div class="line">    override fun toString(): String {</div><div class="line">        return &quot;mapEntry: &quot; + name.toString() + &quot;,value = &quot; + value.toString()</div><div class="line">    }</div><div class="line"></div><div class="line">}</div><div class="line">class Res_value(var size: uint16_t, // &#x5927;&#x5C0F;</div><div class="line">                var res0: uint8_t, // &#x4FDD;&#x7559;&#xFF0C;0</div><div class="line">                var dataType: uint8_t, // &#x7C7B;&#x578B;</div><div class="line">                var data: uint32_t) { // &#x6570;&#x636E;,&#x6839;&#x636E;&#x4E0D;&#x540C;&#x7C7B;&#x578B;&#x6765;&#x5C55;&#x793A;&#x4E0D;&#x540C;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x90E8;&#x5206;&#x57FA;&#x672C;&#x4E0A;&#x662F;&#x7F51;&#x4E0A;&#x62FF;&#x6765;&#x7684;</div><div class="line"></div><div class="line">    val typeStr: String</div><div class="line">        get() {</div><div class="line">            when (dataType.getValue().toInt()) {</div><div class="line">                TYPE_NULL -&gt; return &quot;TYPE_NULL&quot;</div><div class="line">                TYPE_REFERENCE -&gt; return &quot;TYPE_REFERENCE&quot;</div><div class="line">                TYPE_ATTRIBUTE -&gt; return &quot;TYPE_ATTRIBUTE&quot;</div><div class="line">                TYPE_STRING -&gt; return &quot;TYPE_STRING&quot;</div><div class="line">                TYPE_FLOAT -&gt; return &quot;TYPE_FLOAT&quot;</div><div class="line">                TYPE_DIMENSION -&gt; return &quot;TYPE_DIMENSION&quot;</div><div class="line">                TYPE_FRACTION -&gt; return &quot;TYPE_FRACTION&quot;</div><div class="line">                TYPE_FIRST_INT -&gt; return &quot;TYPE_FIRST_INT&quot;</div><div class="line">                TYPE_INT_HEX -&gt; return &quot;TYPE_INT_HEX&quot;</div><div class="line">                TYPE_INT_BOOLEAN -&gt; return &quot;TYPE_INT_BOOLEAN&quot;</div><div class="line">                TYPE_FIRST_COLOR_INT -&gt; return &quot;TYPE_FIRST_COLOR_INT&quot;</div><div class="line">                TYPE_INT_COLOR_RGB8 -&gt; return &quot;TYPE_INT_COLOR_RGB8&quot;</div><div class="line">                TYPE_INT_COLOR_ARGB4 -&gt; return &quot;TYPE_INT_COLOR_ARGB4&quot;</div><div class="line">                TYPE_INT_COLOR_RGB4 -&gt; return &quot;TYPE_INT_COLOR_RGB4&quot;</div><div class="line">            }</div><div class="line">            return &quot;&quot;</div><div class="line">        }</div><div class="line"></div><div class="line">    val dataStr: String</div><div class="line">        get() {</div><div class="line">            if (dataType.getValue().toInt() == TYPE_STRING) {</div><div class="line">                return getStringPoolStr(data.getValue())!!</div><div class="line">            }</div><div class="line">            if (dataType.getValue().toInt() == TYPE_ATTRIBUTE) {</div><div class="line">                return String.format(&quot;?%s%08X&quot;, getPackage(data.getValue()), data.getValue())</div><div class="line">            }</div><div class="line">            if (dataType.getValue().toInt() == TYPE_REFERENCE) {</div><div class="line">                return String.format(&quot;@%s%08X&quot;, getPackage(data.getValue()), data.getValue())</div><div class="line">            }</div><div class="line">            if (dataType.getValue().toInt() == TYPE_FLOAT) {</div><div class="line">                return java.lang.Float.intBitsToFloat(data.getValue()).toString()</div><div class="line">            }</div><div class="line">            if (dataType.getValue().toInt() == TYPE_INT_HEX) {</div><div class="line">                return String.format(&quot;0x%08X&quot;, data.getValue())</div><div class="line">            }</div><div class="line">            if (dataType.getValue().toInt() == TYPE_INT_BOOLEAN) {</div><div class="line">                return if (data.getValue() != 0) &quot;true&quot; else &quot;false&quot;</div><div class="line">            }</div><div class="line">            if (dataType.getValue().toInt() == TYPE_DIMENSION) {</div><div class="line">                return java.lang.Float.toString(complexToFloat(data.getValue())) + DIMENSION_UNITS[data.getValue() and COMPLEX_UNIT_MASK]</div><div class="line">            }</div><div class="line">            if (dataType.getValue().toInt() == TYPE_FRACTION) {</div><div class="line">                return java.lang.Float.toString(complexToFloat(data.getValue())) + FRACTION_UNITS[data.getValue() and COMPLEX_UNIT_MASK]</div><div class="line">            }</div><div class="line">            if (dataType.getValue() in TYPE_FIRST_COLOR_INT..TYPE_LAST_COLOR_INT) {</div><div class="line">                return String.format(&quot;#%08X&quot;, data.getValue())</div><div class="line">            }</div><div class="line">            if (dataType.getValue() in TYPE_FIRST_INT..TYPE_LAST_INT) {</div><div class="line">                return data.getValue().toString()</div><div class="line">            }</div><div class="line">            return String.format(&quot;&lt;0x%X, type 0x%02X&gt;&quot;, data.getValue(), dataType.getValue())</div><div class="line">        }</div><div class="line"></div><div class="line">    override fun toString(): String {</div><div class="line">        return &quot;&quot;&quot;size = ${size.getValue()}, sizeHexValue = ${size.getHexValue()}</div><div class="line">        |res0 = ${res0.getValue()}, res0HexValue = ${res0.getHexValue()}</div><div class="line">        |dataType = ${dataType.getValue()}, dataTypeHexValue = ${dataType.getHexValue()}, typeStr = $typeStr</div><div class="line">        |data = ${data.getValue()}, dataHexValue = ${data.getHexValue()}, dataStr = $dataStr&quot;&quot;&quot;.trimMargin()</div><div class="line">    }</div><div class="line"></div><div class="line">    companion object {</div><div class="line"></div><div class="line">        val TYPE_NULL = 0x00</div><div class="line">        val TYPE_REFERENCE = 0x01</div><div class="line">        val TYPE_ATTRIBUTE = 0x02</div><div class="line">        val TYPE_STRING = 0x03</div><div class="line">        val TYPE_FLOAT = 0x04</div><div class="line">        val TYPE_DIMENSION = 0x05</div><div class="line">        val TYPE_FRACTION = 0x06</div><div class="line">        val TYPE_FIRST_INT = 0x10</div><div class="line">        val TYPE_INT_DEC = 0x10</div><div class="line">        val TYPE_INT_HEX = 0x11</div><div class="line">        val TYPE_INT_BOOLEAN = 0x12</div><div class="line">        val TYPE_FIRST_COLOR_INT = 0x1c</div><div class="line">        val TYPE_INT_COLOR_ARGB8 = 0x1c</div><div class="line">        val TYPE_INT_COLOR_RGB8 = 0x1d</div><div class="line">        val TYPE_INT_COLOR_ARGB4 = 0x1e</div><div class="line">        val TYPE_INT_COLOR_RGB4 = 0x1f</div><div class="line">        val TYPE_LAST_COLOR_INT = 0x1f</div><div class="line">        val TYPE_LAST_INT = 0x1f</div><div class="line"></div><div class="line">        val COMPLEX_UNIT_PX = 0</div><div class="line">        val COMPLEX_UNIT_DIP = 1</div><div class="line">        val COMPLEX_UNIT_SP = 2</div><div class="line">        val COMPLEX_UNIT_PT = 3</div><div class="line">        val COMPLEX_UNIT_IN = 4</div><div class="line">        val COMPLEX_UNIT_MM = 5</div><div class="line">        val COMPLEX_UNIT_SHIFT = 0</div><div class="line">        val COMPLEX_UNIT_MASK = 15</div><div class="line">        val COMPLEX_UNIT_FRACTION = 0</div><div class="line">        val COMPLEX_UNIT_FRACTION_PARENT = 1</div><div class="line">        val COMPLEX_RADIX_23p0 = 0</div><div class="line">        val COMPLEX_RADIX_16p7 = 1</div><div class="line">        val COMPLEX_RADIX_8p15 = 2</div><div class="line">        val COMPLEX_RADIX_0p23 = 3</div><div class="line">        val COMPLEX_RADIX_SHIFT = 4</div><div class="line">        val COMPLEX_RADIX_MASK = 3</div><div class="line">        val COMPLEX_MANTISSA_SHIFT = 8</div><div class="line">        val COMPLEX_MANTISSA_MASK = 0xFFFFFF</div><div class="line"></div><div class="line">        private fun getPackage(id: Int): String {</div><div class="line">            if (id.ushr(24) == 1) {</div><div class="line">                return &quot;android:&quot;</div><div class="line">            }</div><div class="line">            return &quot;&quot;</div><div class="line">        }</div><div class="line"></div><div class="line">        fun complexToFloat(complex: Int): Float {</div><div class="line">            return (complex and 0xFFFFFF00.toInt()).toFloat() * RADIX_MULTS[complex shr 4 and 3]</div><div class="line">        }</div><div class="line"></div><div class="line">        private val RADIX_MULTS = floatArrayOf(0.00390625f, 3.051758E-005f, 1.192093E-007f, 4.656613E-010f)</div><div class="line"></div><div class="line">        private val DIMENSION_UNITS = arrayOf(&quot;px&quot;, &quot;dip&quot;, &quot;sp&quot;, &quot;pt&quot;, &quot;in&quot;, &quot;mm&quot;, &quot;&quot;, &quot;&quot;)</div><div class="line"></div><div class="line">        private val FRACTION_UNITS = arrayOf(&quot;%&quot;, &quot;%p&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;)</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>&#x4E0A;&#x9762;&#x7684;&#x7ED3;&#x6784;&#x5B9A;&#x4E49;&#x786E;&#x5B9E;&#x5F88;&#x591A;&#xFF0C;&#x6709;&#x4E00;&#x90E8;&#x5206;&#x662F;&#x4ECE;&#x5148;&#x4EBA;&#x7684;&#x535A;&#x5BA2;&#x4E2D;&#x6458;&#x6284;&#x7684;&#xFF0C;&#x4F46;&#x6211;&#x5E76;&#x4E0D;&#x8BA4;&#x4E3A;&#x4ED6;&#x4EEC;&#x7684;&#x5168;&#x662F;&#x6B63;&#x786E;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x6211;&#x81EA;&#x5DF1;&#x89E3;&#x6790;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E00;&#x6B21;&#x6B21;&#x80AF;&#x5B9A;&#x53C8;&#x4E00;&#x6B21;&#x6B21;&#x5426;&#x5B9A;&#xFF0C;&#x6162;&#x6162;&#x81EA;&#x5DF1;&#x53D1;&#x73B0;&#x89C4;&#x5F8B;&#x5E76;&#x5B8C;&#x6210;&#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x3002;<br>&#x4E0A;&#x9762;&#x7ED3;&#x6784;&#x4F53;ResTable_type&#x5B9A;&#x4E49;&#x4E86;&#x8BE5;&#x8D44;&#x6E90;&#x9879;&#x7684;&#x8D44;&#x6E90;id&#x3001;&#x603B;&#x4E2A;&#x6570;&#x3001;&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#x4EE5;&#x53CA;&#x504F;&#x79FB;&#x91CF;&#xFF0C;&#x63A5;&#x7740;&#x6839;&#x636E;ResTable_entry&#x7684;flags&#x6765;&#x5224;&#x65AD;&#x5177;&#x4F53;&#x662F;ResTable_map_entry&#x8FD8;&#x662F;ResTable_entry&#xFF0C;&#x8FD9;&#x91CC;&#x9762;&#x5B9A;&#x4E49;&#x4E86;size&#xFF0C;&#x5373;&#x5927;&#x5C0F;&#x3002;&#x5982;&#x679C;&#x7C7B;&#x578B;&#x662F;ResTable_map_entry&#xFF0C;&#x5219;&#x6839;&#x636E;ResTable_map_entry&#x7684;count&#x8BBE;&#x7F6E;&#x5177;&#x4F53;&#x7684;ResTable_map&#xFF0C;ResTable_map&#x4E2D;&#x5305;&#x62EC;&#x4E86;&#x8D44;&#x6E90;&#x9879;&#x7684;id&#x548C;&#x503C;&#xFF08;Res_value&#xFF09;&#x3002;&#x5982;&#x679C;&#x7C7B;&#x578B;&#x662F;ResTable_entry&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x91CC;&#x4F1A;&#x6709;&#x4E00;&#x4E2A;&#x8D44;&#x6E90;&#x9879;&#x7684;&#x503C;Res_value&#x3002;Res_value&#x4E2D;&#x6839;&#x636E;&#x7C7B;&#x578B;&#xFF08;dataType&#xFF09;&#x6765;&#x5224;&#x65AD;&#x5177;&#x4F53;&#x5C5E;&#x4E8E;&#x4EC0;&#x4E48;&#x7C7B;&#x578B;&#xFF0C;&#x5E76;&#x6839;&#x636E;&#x7C7B;&#x578B;&#x548C;&#x6570;&#x636E;&#xFF08;data&#xFF09;&#x6765;&#x83B7;&#x5F97;&#x5177;&#x4F53;&#x7684;&#x503C;&#x3002;</p>
</blockquote>
<hr>
<h1 id="10-&#x89E3;&#x6790;&#x8FC7;&#x7A0B;"><a href="#10-&#x89E3;&#x6790;&#x8FC7;&#x7A0B;" class="headerlink" title="10. &#x89E3;&#x6790;&#x8FC7;&#x7A0B;"></a>10. &#x89E3;&#x6790;&#x8FC7;&#x7A0B;</h1><blockquote>
<p>&#x4E86;&#x89E3;&#x4E86;resources.arsc&#x7684;&#x6587;&#x4EF6;&#x7ED3;&#x6784;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7ED3;&#x6784;&#x548C;&#x4E8C;&#x8FDB;&#x5236;&#x6587;&#x4EF6;&#x67E5;&#x770B;&#x5668;&#x6765;&#x8FDB;&#x884C;&#x6587;&#x4EF6;&#x7684;&#x89E3;&#x6790;&#x3002;</p>
<h2 id="10-1-&#x5DE5;&#x5177;&#x7C7B;&#x548C;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;"><a href="#10-1-&#x5DE5;&#x5177;&#x7C7B;&#x548C;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;" class="headerlink" title="10.1  &#x5DE5;&#x5177;&#x7C7B;&#x548C;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;"></a>10.1  &#x5DE5;&#x5177;&#x7C7B;&#x548C;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div></pre></td><td class="code"><pre><div class="line">ibasic_unit:&#x57FA;&#x7840;&#x7684;&#x63A5;&#x53E3;</div><div class="line">interface ibasic_unit&lt;T&gt; {</div><div class="line">    fun getValue(): T //value</div><div class="line">    fun getHexValue(): String // &#x8FD4;&#x56DE;16&#x8FDB;&#x5236;&#x683C;&#x5F0F;&#x5316;&#x5B57;&#x7B26;&#x4E32;</div><div class="line">}</div><div class="line">basic_unit:&#x57FA;&#x7840;&#x7684;&#x62BD;&#x8C61;&#x5B9E;&#x73B0;&#x7C7B;</div><div class="line">abstract class basic_unit&lt;T&gt;(protected var relValue: T) : ibasic_unit&lt;T&gt; {</div><div class="line">    override fun getValue(): T {</div><div class="line">        return relValue</div><div class="line">    }</div><div class="line">}</div><div class="line">uint8_t:&#x8BFB;&#x53D6;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x5BF9;&#x5E94;&#x7C7B;&#x578B;&#x662F;Byte</div><div class="line">class uint8_t(value: Byte) : basic_unit&lt;Byte&gt;(value) {</div><div class="line">    override fun getHexValue(): String {</div><div class="line">        var toHexString = Integer.toHexString(getValue().toInt())</div><div class="line">        if (toHexString.length &lt; 2) {</div><div class="line">            for (i in 1..2 - toHexString.length) {</div><div class="line">                toHexString = &quot;0&quot; + toHexString</div><div class="line">            }</div><div class="line">        }</div><div class="line">        return &quot;0x&quot; + toHexString</div><div class="line">    }</div><div class="line">}</div><div class="line">uint16_t:&#x8BFB;&#x53D6;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x5BF9;&#x5E94;&#x7684;&#x503C;&#x7684;&#x7C7B;&#x578B;&#x662F;Short</div><div class="line">class uint16_t(value: Short) : basic_unit&lt;Short&gt;(value) {</div><div class="line">    override fun getValue(): Short {</div><div class="line">        return getShortValue(relValue)</div><div class="line">    }</div><div class="line"></div><div class="line">    override fun getHexValue(): String {</div><div class="line">        var toHexString = Integer.toHexString(com.nick.model.type.getShortValue(relValue).toInt())</div><div class="line">        if (toHexString.length &lt; 4) {</div><div class="line">            for (i in 1..4 - toHexString.length) {</div><div class="line">                toHexString = &quot;0&quot; + toHexString</div><div class="line">            }</div><div class="line">        }</div><div class="line">        return &quot;0x&quot; + toHexString</div><div class="line">    }</div><div class="line">}</div><div class="line">uint32_t:&#x8BFB;&#x53D6;&#x56DB;&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x503C;&#xFF0C;&#x5BF9;&#x5E94;&#x7C7B;&#x578B;&#x662F;Int</div><div class="line">class uint32_t(var value: Int) : basic_unit&lt;Int&gt;(value) {</div><div class="line">    override fun getValue(): Int {</div><div class="line">        return getIntValue(relValue)</div><div class="line">    }</div><div class="line"></div><div class="line">    override fun getHexValue(): String {</div><div class="line">        var toHexString = Integer.toHexString(getValue())</div><div class="line">        if (toHexString.length &lt; 8) {</div><div class="line">            for (i in 1..(8 - toHexString.length)) {</div><div class="line">                toHexString = &quot;0&quot; + toHexString</div><div class="line">            }</div><div class="line">        }</div><div class="line">        return &quot;0x&quot; + toHexString</div><div class="line">    }</div><div class="line">}</div><div class="line">Config:&#x914D;&#x7F6E;&#x4FE1;&#x606F;</div><div class="line">class Config {</div><div class="line">    companion object {</div><div class="line">        val RESCHUNK_HEADER_SIZE = 8 //chunk&#x5934;&#x90E8;&#x5927;&#x5C0F;</div><div class="line">        val RESTABLE_MAP_SIZE = 12 //res table map&#x5927;&#x5C0F;</div><div class="line">        val RES_VALUE_SIZE = 8 //res value&#x5927;&#x5C0F;</div><div class="line">    }</div><div class="line">}</div><div class="line">ReadUtils.kt:</div><div class="line">var stringList: Array&lt;String&gt;? = null //&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x6570;&#x7EC4;</div><div class="line"></div><div class="line">//&#x8BFB;&#x53D6;uint8_t</div><div class="line">fun read_uint8_t(byteArray: ByteArray, offset: Int): uint8_t {</div><div class="line">    return uint8_t(byteArray[offset])</div><div class="line">}</div><div class="line"></div><div class="line">fun byte22Uint16_t(byteArray: ByteArray): uint16_t {</div><div class="line">    var value: Short = 0</div><div class="line">    for (i in 0..1) {</div><div class="line">        value = (value.toInt() shl 8).toShort()</div><div class="line">        value = value or (byteArray[i].toInt() and 0xFF).toShort()</div><div class="line">    }</div><div class="line">    return uint16_t(value)</div><div class="line">}</div><div class="line"></div><div class="line">//&#x8BFB;&#x53D6;uint16_t</div><div class="line">fun read_uint16_t(stream: ByteArray, index: Int): uint16_t {</div><div class="line">    val byte = ByteArray(2)</div><div class="line">    byte[0] = stream[index]</div><div class="line">    byte[1] = stream[index + 1]</div><div class="line"></div><div class="line">    var value: Short = 0</div><div class="line">    for (i in 0..1) {</div><div class="line">        value = (value.toInt() shl 8).toShort()</div><div class="line">        value = value or (byte[i].toInt() and 0xFF).toShort()</div><div class="line">    }</div><div class="line">    return uint16_t(value)</div><div class="line">}</div><div class="line"></div><div class="line">//&#x8BFB;&#x53D6;uint32_t</div><div class="line">fun read_uint32_t(stream: ByteArray, index: Int): uint32_t {</div><div class="line">    val byte = ByteArray(4)</div><div class="line">    for (i in 0..byte.size - 1) {</div><div class="line">        byte[i] = stream[index + i]</div><div class="line">    }</div><div class="line"></div><div class="line">    var value: Int = 0</div><div class="line">    for (i in 0..3) {</div><div class="line">        value = value shl 8</div><div class="line">        value = value or (byte[i].toInt() and 0xFF)</div><div class="line">    }</div><div class="line">    return uint32_t(value)</div><div class="line">}</div><div class="line"></div><div class="line">//&#x8BFB;&#x53D6;uint64_t</div><div class="line">fun read_uint64_t(stream: ByteArray, index: Int): uint64_t {</div><div class="line">    val byte = ByteArray(8)</div><div class="line">    for (i in 0..byte.size - 1) {</div><div class="line">        byte[i] = stream[index + i]</div><div class="line">    }</div><div class="line"></div><div class="line">    var value: Long = 0</div><div class="line">    for (i in 0..7) {</div><div class="line">        value = value shl 8</div><div class="line">        value = value or (byte[i].toLong() and 0xFF)</div><div class="line">    }</div><div class="line">    return uint64_t(value)</div><div class="line">}</div><div class="line"></div><div class="line">//&#x8BFB;&#x53D6;&#x5B57;&#x7B26;&#x4E32;</div><div class="line">fun readString2(stream: ByteArray, size: Int, index: Int): Pair&lt;String, Int&gt; {</div><div class="line">    val bytes = ByteArray(1)</div><div class="line">    val byteArray = ByteArray(1)</div><div class="line">    var realSize = 0</div><div class="line">    bytes[0] = stream[index]</div><div class="line">    byteArray[0] = stream[index + 1]</div><div class="line">    var c = 1</div><div class="line">    if (bytes[0].toInt() and 0x80 != 0) {</div><div class="line">        c++</div><div class="line">        byteArray[0] = stream[index + c]</div><div class="line">    }</div><div class="line">    var result = &quot;&quot;</div><div class="line">    realSize = byteArray[0].toInt()</div><div class="line">    var i = 0</div><div class="line">    while (realSize and (0x80 shl i) != 0) {</div><div class="line">        c++</div><div class="line">        byteArray[0] = stream[index + c]</div><div class="line">        realSize = ((realSize and 0x7f) shl 8) or (byteArray[0].toInt() and 0xff)</div><div class="line">        i += 4</div><div class="line">    }</div><div class="line"></div><div class="line">    if (realSize &gt; 0) {</div><div class="line">        val tempBytes = ByteArray(realSize)</div><div class="line">        for (j in 0..tempBytes.size - 1) {</div><div class="line">            tempBytes[j] = stream[index + c + 1 + j]</div><div class="line">        }</div><div class="line">        result += &quot;${String(tempBytes)}  realSize = $realSize size = $size c = $c&quot;</div><div class="line">    }</div><div class="line"></div><div class="line">    val resultPair = Pair(result, realSize + c + i + 1)</div><div class="line"></div><div class="line">    return resultPair</div><div class="line">}</div><div class="line"></div><div class="line">//&#x6839;&#x636E;&#x5B57;&#x7B26;&#x4E32;size&#x8BFB;&#x53D6;&#x5B57;&#x7B26;&#x4E32;</div><div class="line">fun readStringWithSize(stream: ByteArray, offset: Int, size: Int): String {</div><div class="line">    var result = &quot;&quot;</div><div class="line">    if (size &gt; 0) {</div><div class="line">        val tempBytes = ByteArray(size)</div><div class="line"></div><div class="line">        for (i in 0..tempBytes.size - 1) {</div><div class="line">            tempBytes[i] = stream[offset + i]</div><div class="line">        }</div><div class="line"></div><div class="line">        result = String(tempBytes)</div><div class="line">    }</div><div class="line"></div><div class="line">    return result</div><div class="line">}</div><div class="line"></div><div class="line">//&#x8BFB;&#x53D6;chunk&#x7684;&#x5934;&#x90E8;</div><div class="line">fun getResChunk_header(stream: ByteArray, index: Int): ResChunk_header {</div><div class="line">    return ResChunk_header(read_uint16_t(stream, index), read_uint16_t(stream, index + 2), read_uint32_t(stream, index + 4))</div><div class="line">}</div><div class="line"></div><div class="line">//&#x5F97;&#x5230;int&#x503C;</div><div class="line">fun getIntValue(value: Int): Int {</div><div class="line">    val bytes = ByteArray(4)</div><div class="line">    bytes[0] = (value and 0x000000ff).toByte()</div><div class="line">    bytes[1] = ((value ushr 8) and 0x000000ff).toByte()</div><div class="line">    bytes[2] = ((value ushr 16) and 0x000000ff).toByte()</div><div class="line">    bytes[3] = ((value ushr 24) and 0x000000ff).toByte()</div><div class="line">    var result: Int = 0</div><div class="line">    for (i in 0..3) {</div><div class="line">        result = result shl 8</div><div class="line">        result = result or (bytes[i].toInt() and 0xFF)</div><div class="line">    }</div><div class="line">    return result</div><div class="line">}</div><div class="line">//&#x5F97;&#x5230;long&#x503C;</div><div class="line">fun getLongValue(value: Long): Long {</div><div class="line">    val bytes = ByteArray(8)</div><div class="line">    bytes[0] = (value and 0x000000ff).toByte()</div><div class="line">    bytes[1] = ((value ushr 8) and 0x000000ff).toByte()</div><div class="line">    bytes[2] = ((value ushr 16) and 0x000000ff).toByte()</div><div class="line">    bytes[3] = ((value ushr 24) and 0x000000ff).toByte()</div><div class="line">    bytes[0] = ((value ushr 32) and 0x000000ff).toByte()</div><div class="line">    bytes[1] = ((value ushr 40) and 0x000000ff).toByte()</div><div class="line">    bytes[2] = ((value ushr 48) and 0x000000ff).toByte()</div><div class="line">    bytes[3] = ((value ushr 56) and 0x000000ff).toByte()</div><div class="line">    var result: Long = 0</div><div class="line">    for (i in 0..bytes.size - 1) {</div><div class="line">        result = result shl 8</div><div class="line">        result = result or (bytes[i].toLong() and 0xFF)</div><div class="line">    }</div><div class="line">    return result</div><div class="line">}</div><div class="line">//&#x5F97;&#x5230;short&#x503C;</div><div class="line">fun getShortValue(value: Short): Short {</div><div class="line">    val bytes = ByteArray(2)</div><div class="line">    bytes[0] = (value and 0x00ff).toByte()</div><div class="line">    bytes[1] = ((value.toInt() shr 8) and 0x00ff).toByte()</div><div class="line">    var result: Short = 0</div><div class="line">    for (i in 0..1) {</div><div class="line">        result = (result.toInt() shl 8).toShort()</div><div class="line">        result = result or (bytes[i].toInt() and 0xFF).toShort()</div><div class="line">    }</div><div class="line">    return result</div><div class="line">}</div><div class="line">//&#x5F97;&#x5230;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x4E2D;&#x5177;&#x4F53;&#x7684;&#x503C;</div><div class="line">fun getStringPoolStr(index: Int): String? {</div><div class="line">    if (stringList == null || stringList?.get(index).isNullOrEmpty()) {</div><div class="line">        return &quot;&quot;</div><div class="line">    }</div><div class="line">    return stringList?.get(index)</div><div class="line">}</div></pre></td></tr></table></figure>
<p>&#x5DE5;&#x5177;&#x7C7B;&#x91CC;&#x9762;&#x4E3B;&#x8981;&#x5305;&#x62EC;&#x4E86;&#x6240;&#x6709;&#x7C7B;&#x578B;&#x7684;&#x8BFB;&#x53D6;&#xFF0C;chunk&#x5934;&#x90E8;&#x4FE1;&#x606F;&#x7684;&#x8BFB;&#x53D6;&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x8BFB;&#x53D6;&#x4EE5;&#x53CA;&#x771F;&#x6B63;&#x503C;&#x7684;&#x8F6C;&#x6362;&#x3002;</p>
</blockquote>
<hr>
<h2 id="10-2-&#x6587;&#x4EF6;&#x8BFB;&#x53D6;&#x548C;&#x5B57;&#x8282;&#x6570;&#x7EC4;&#x8F6C;&#x6362;"><a href="#10-2-&#x6587;&#x4EF6;&#x8BFB;&#x53D6;&#x548C;&#x5B57;&#x8282;&#x6570;&#x7EC4;&#x8F6C;&#x6362;" class="headerlink" title="10.2  &#x6587;&#x4EF6;&#x8BFB;&#x53D6;&#x548C;&#x5B57;&#x8282;&#x6570;&#x7EC4;&#x8F6C;&#x6362;"></a>10.2  &#x6587;&#x4EF6;&#x8BFB;&#x53D6;&#x548C;&#x5B57;&#x8282;&#x6570;&#x7EC4;&#x8F6C;&#x6362;</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">val stream = File(&quot;H:\\javaworkpace\\idea\\resourcesAnalyzer\\src\\com\\nick\\resources.arsc&quot;).inputStream()</div><div class="line">val os = ByteArrayOutputStream()</div><div class="line">val bytes = ByteArray(1024)</div><div class="line">var len = stream.read(bytes)</div><div class="line">while (len != -1) {</div><div class="line">    os.write(bytes, 0, len)</div><div class="line">    len = stream.read(bytes)</div><div class="line">}</div></pre></td></tr></table></figure>
<h2 id="10-3-&#x89E3;&#x6790;ResTable-header&#x4FE1;&#x606F;"><a href="#10-3-&#x89E3;&#x6790;ResTable-header&#x4FE1;&#x606F;" class="headerlink" title="10.3 &#x89E3;&#x6790;ResTable_header&#x4FE1;&#x606F;"></a>10.3 &#x89E3;&#x6790;ResTable_header&#x4FE1;&#x606F;</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">println(&quot;---------------------&#x89E3;&#x6790;ResTable_header&#x4FE1;&#x606F;&#x5F00;&#x59CB;---------------------&quot;)</div><div class="line">val resTable_header = ResTable_header(getResChunk_header(streamByte, 0), read_uint32_t(streamByte, Config.RESCHUNK_HEADER_SIZE))</div><div class="line">println(resTable_header)</div><div class="line">println(&quot;---------------------&#x89E3;&#x6790;ResTable_header&#x4FE1;&#x606F;&#x5B8C;&#x6BD5;---------------------&quot;)</div></pre></td></tr></table></figure>
<blockquote>
<p>&#x6709;&#x4E86;&#x7C7B;&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5F88;&#x7B80;&#x5355;&#x7684;&#x53BB;&#x89E3;&#x6790;&#x5934;&#x90E8;&#x7684;&#x4FE1;&#x606F;&#x3002;&#x8F93;&#x51FA;&#x5982;&#x4E0B;&#xFF1A;<br><img src="http://upload-images.jianshu.io/upload_images/5720362-d8ad7715761bf23e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="table header&#x8F93;&#x51FA;.png"></p>
</blockquote>
<hr>
<h1 id="10-4-&#x89E3;&#x6790;&#x5B57;&#x7B26;&#x4E32;&#x8D44;&#x6E90;&#x6C60;"><a href="#10-4-&#x89E3;&#x6790;&#x5B57;&#x7B26;&#x4E32;&#x8D44;&#x6E90;&#x6C60;" class="headerlink" title="10.4 &#x89E3;&#x6790;&#x5B57;&#x7B26;&#x4E32;&#x8D44;&#x6E90;&#x6C60;"></a>10.4 &#x89E3;&#x6790;&#x5B57;&#x7B26;&#x4E32;&#x8D44;&#x6E90;&#x6C60;</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div></pre></td><td class="code"><pre><div class="line">    // &#x504F;&#x79FB;&#x91CF;&#x5373;headerSize</div><div class="line">    offset = resTable_header.header.headerSize.getValue().toInt()</div><div class="line">    //&#x8BFB;&#x53D6;&#x5B57;&#x7B26;&#x4E32;&#x6C60;</div><div class="line">    val resStringPool_header = resStringPool_header(streamByte, offset)</div><div class="line">    //&#x5168;&#x5C40;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x6570;&#x7EC4;&#x4FDD;&#x5B58;</div><div class="line">    stringList = resStringPool_header.stringStringArray!!.stringArray</div><div class="line"></div><div class="line">private fun resStringPool_header(streamByte: ByteArray, offset: Int): ResStringPool_header {</div><div class="line">    println(&quot;---------------------&#x89E3;&#x6790;ResStringPool_header&#x4FE1;&#x606F;&#x5F00;&#x59CB;---------------------&quot;)</div><div class="line">    val resStringPool_header = ResStringPool_header(getResChunk_header(streamByte, offset),</div><div class="line">            read_uint32_t(streamByte, offset + Config.RESCHUNK_HEADER_SIZE),</div><div class="line">            read_uint32_t(streamByte, offset + Config.RESCHUNK_HEADER_SIZE + 4),</div><div class="line">            read_uint32_t(streamByte, offset + Config.RESCHUNK_HEADER_SIZE + 8),</div><div class="line">            read_uint32_t(streamByte, offset + Config.RESCHUNK_HEADER_SIZE + 12),</div><div class="line">            read_uint32_t(streamByte, offset + Config.RESCHUNK_HEADER_SIZE + 16),</div><div class="line">            null,</div><div class="line">            null,</div><div class="line">            null,</div><div class="line">            null)</div><div class="line">    println(resStringPool_header)</div><div class="line">    println(&quot;---------------------&#x89E3;&#x6790;ResStringPool_header&#x4FE1;&#x606F;&#x5B8C;&#x6BD5;---------------------&quot;)</div><div class="line">    //&#x89E3;&#x6790;&#x5B8C;&#x6210;&#x540E;&#x4F1A;&#x6709;&#x4E24;&#x4E2A;&#x504F;&#x79FB;&#x6570;&#x7EC4;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;string&#x504F;&#x79FB;&#x6570;&#x7EC4;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x662F;style&#x504F;&#x79FB;&#x6570;&#x7EC4;</div><div class="line"></div><div class="line">    // string&#x504F;&#x79FB;&#x6570;&#x7EC4;</div><div class="line">    val stringCount = resStringPool_header.stringCount.getValue()</div><div class="line">    val resString_offset_array = ResString_offset_array(Array(stringCount, {</div><div class="line">        uint32_t(0)</div><div class="line">    }))</div><div class="line">    for (i in 0..stringCount - 1) {</div><div class="line">        resString_offset_array.offset_array[i] = read_uint32_t(streamByte, resStringPool_header.header.headerSize.getValue() + offset + i * 4)</div><div class="line">    }</div><div class="line"></div><div class="line">    // style&#x504F;&#x79FB;&#x6570;&#x7EC4;</div><div class="line">    val styleCount = resStringPool_header.styleCount.getValue()</div><div class="line">    val resStyle_offset_array = ResStyle_offset_array(Array(styleCount, {</div><div class="line">        uint32_t(0)</div><div class="line">    }))</div><div class="line">    for (i in 0..styleCount - 1) {</div><div class="line">        resStyle_offset_array.offset_array[i] = read_uint32_t(streamByte, resStringPool_header.header.headerSize.getValue() + stringCount * 4 + offset + i * 4)</div><div class="line">    }</div><div class="line"></div><div class="line">    //&#x89E3;&#x6790;&#x5B57;&#x7B26;&#x4E32;&#x6C60;</div><div class="line">    val stringStartOffset = offset + resStringPool_header.stringsStart.getValue()</div><div class="line">    val stringArray: Array&lt;String&gt; = Array(resStringPool_header.stringCount.getValue(), {</div><div class="line">        &quot;&quot;</div><div class="line">    })</div><div class="line"></div><div class="line">    for (i in 0..resStringPool_header.stringCount.getValue() - 1) {</div><div class="line">        var size: Int</div><div class="line">        if (i + 1 &lt;= resStringPool_header.stringCount.getValue() - 1) {</div><div class="line">            size = resString_offset_array.offset_array[i + 1].getValue() - resString_offset_array.offset_array[i].getValue()</div><div class="line">        } else {</div><div class="line">            size = resStringPool_header.header.size.getValue() - resString_offset_array.offset_array[i].getValue() - resStringPool_header.stringCount.getValue() * 4 - 28</div><div class="line">        }</div><div class="line">        val resultPair = readString2(streamByte, size, stringStartOffset + resString_offset_array.offset_array[i].getValue())</div><div class="line">        stringArray[i] = resultPair.first</div><div class="line">    }</div><div class="line"></div><div class="line">    //&#x8D44;&#x6E90;&#x5B57;&#x7B26;&#x4E32;&#x503C;</div><div class="line">    val resString_string_array = ResString_string_array(stringArray)</div><div class="line">    resString_string_array.stringArray.forEachIndexed { index, s -&gt;</div><div class="line">        println(&quot;$index : $s&quot;)</div><div class="line">    }</div><div class="line"></div><div class="line">    println(&quot;----------------------&#x8BFB;&#x53D6;style----------------------&quot;)</div><div class="line">    val styleStartOffset = offset + resStringPool_header.stylesStart.getValue()</div><div class="line">    val styleStringArray: Array&lt;ResStringPool_span&gt; = Array(resStringPool_header.styleCount.getValue(), {</div><div class="line">        ResStringPool_span(</div><div class="line">                ResStringPool_ref(uint32_t(0)),</div><div class="line">                uint32_t(0),</div><div class="line">                uint32_t(0)</div><div class="line">        )</div><div class="line">    })</div><div class="line"></div><div class="line">    for (i in 0..resStringPool_header.styleCount.getValue() - 1) {</div><div class="line">        styleStringArray[i] = ResStringPool_span(</div><div class="line">                ResStringPool_ref(read_uint32_t(streamByte, styleStartOffset + resStyle_offset_array.offset_array[i].getValue())),</div><div class="line">                read_uint32_t(streamByte, styleStartOffset + resStyle_offset_array.offset_array[i].getValue() + 4),</div><div class="line">                read_uint32_t(streamByte, styleStartOffset + resStyle_offset_array.offset_array[i].getValue() + 8)</div><div class="line">        )</div><div class="line">    }</div><div class="line"></div><div class="line">    for (i in 0..resStringPool_header.styleCount.getValue() - 1) {</div><div class="line">        println(styleStringArray[i])</div><div class="line">    }</div><div class="line"></div><div class="line">    resStringPool_header.stringOffsetArray = resString_offset_array</div><div class="line">    resStringPool_header.styleOffsetArray = resStyle_offset_array</div><div class="line">    resStringPool_header.stringStringArray = resString_string_array</div><div class="line">    resStringPool_header.styleStringArray = ResStyle_string_array(styleStringArray)</div><div class="line">    return resStringPool_header</div><div class="line">}</div></pre></td></tr></table></figure>
<blockquote>
<p>&#x8FD9;&#x4E00;&#x90E8;&#x5206;&#x5176;&#x5B9E;&#x89E3;&#x6790;&#x5E76;&#x4E0D;&#x96BE;&#xFF0C;&#x96BE;&#x7684;&#x662F;&#x5173;&#x4E8E;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#x7684;&#x8BA1;&#x7B97;&#x3002;&#x6B63;&#x5982;&#x6211;&#x4E4B;&#x524D;&#x8BF4;&#x7684;&#xFF0C;&#x957F;&#x5EA6;&#x8BA1;&#x7B97;&#x6211;&#x5728;&#x7F51;&#x4E0A;&#x67E5;&#x4E86;&#x4E0D;&#x5C11;&#x8D44;&#x6599;&#xFF0C;&#x4F46;&#x662F;&#x5B9E;&#x9645;&#x64CD;&#x4F5C;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x603B;&#x4F1A;&#x51FA;&#x73B0;&#x4E71;&#x7801;&#xFF08;&#x957F;&#x5EA6;&#x8BA1;&#x7B97;&#x9519;&#x8BEF;&#xFF09;&#x7684;&#x73B0;&#x8C61;&#x3002;&#x8BF4;&#x5B9E;&#x8BDD;&#xFF0C;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x6211;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5176;&#x4ED6;&#x65B9;&#x6CD5;&#x6765;&#x8DF3;&#x8FC7;&#xFF0C;&#x5C31;&#x5982;&#x4EE3;&#x7801;&#x91CC;&#x5199;&#x7684;&#xFF0C;&#x901A;&#x8FC7;&#x504F;&#x79FB;&#x6570;&#x7EC4;&#x6765;&#x5224;&#x65AD;&#x5177;&#x4F53;&#x957F;&#x5EA6;&#xFF0C;&#x89E3;&#x6790;&#x7684;&#x65F6;&#x5019;&#x6839;&#x636E;&#x957F;&#x5EA6;&#x6765;&#x89E3;&#x6790;&#x3002;&#x4F46;&#x662F;&#x8FD9;&#x4E48;&#x505A;&#x660E;&#x663E;&#x662F;&#x4E2A;&#x9519;&#x8BEF;&#x7684;&#x505A;&#x6CD5;&#x3002;&#x7ECF;&#x8FC7;&#x51E0;&#x5929;&#x7684;&#x63A2;&#x7D22;&#xFF0C;&#x627E;&#x51FA;&#x4E86;&#x81EA;&#x8BA4;&#x4E3A;&#x662F;&#x6B63;&#x786E;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x6700;&#x540E;&#x5B8C;&#x6210;&#x4E86;&#x8FD9;&#x90E8;&#x5206;&#x7684;&#x89E3;&#x6790;&#x3002;&#x89E3;&#x6790;&#x7ED3;&#x679C;&#xFF08;&#x90E8;&#x5206;&#xFF09;&#xFF1A;<br><img src="http://upload-images.jianshu.io/upload_images/5720362-7b3d16571390e374.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="&#x5B57;&#x7B26;&#x4E32;&#x6C60;.png"></p>
</blockquote>
<hr>
<h2 id="10-5-Package&#x4FE1;&#x606F;&#x89E3;&#x6790;"><a href="#10-5-Package&#x4FE1;&#x606F;&#x89E3;&#x6790;" class="headerlink" title="10.5 Package&#x4FE1;&#x606F;&#x89E3;&#x6790;"></a>10.5 Package&#x4FE1;&#x606F;&#x89E3;&#x6790;</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">println(&quot;&#x8BFB;&#x53D6;Package&#x4FE1;&#x606F;&quot;)</div><div class="line">// package&#x7684;&#x504F;&#x79FB;&#x91CF;</div><div class="line">val packageOffset = resStringPool_header.header.size.getValue() + offset</div><div class="line">// &#x89E3;&#x6790;Package&#x6570;&#x636E;&#x5757;</div><div class="line">val resTable_package = ResTable_package(</div><div class="line">        getResChunk_header(streamByte, packageOffset),</div><div class="line">        read_uint32_t(streamByte, packageOffset + Config.RESCHUNK_HEADER_SIZE),</div><div class="line">        readStringWithSize(streamByte, packageOffset + Config.RESCHUNK_HEADER_SIZE + 4, 256),</div><div class="line">        read_uint32_t(streamByte, packageOffset + Config.RESCHUNK_HEADER_SIZE + 4 + 256),</div><div class="line">        read_uint32_t(streamByte, packageOffset + Config.RESCHUNK_HEADER_SIZE + 4 + 256 + 4),</div><div class="line">        read_uint32_t(streamByte, packageOffset + Config.RESCHUNK_HEADER_SIZE + 4 + 256 + 4 + 4),</div><div class="line">        read_uint32_t(streamByte, packageOffset + Config.RESCHUNK_HEADER_SIZE + 4 + 256 + 4 + 4 + 4))</div><div class="line">println(resTable_package)</div><div class="line">println(&quot;&#x8BFB;&#x53D6;Package&#x4FE1;&#x606F;&#x5B8C;&#x6BD5;&quot;)</div><div class="line"></div><div class="line">// &#x89E3;&#x6790;&#x8D44;&#x6E90;&#x7C7B;&#x578B;</div><div class="line">// &#x504F;&#x79FB;&#x91CF;&#x8BBE;&#x7F6E;&#xFF0C;</div><div class="line">val resTypePoolOffset = resTable_package.header.headerSize.getValue().toInt() + packageOffset</div><div class="line">val resTypeStringPool_header = resStringPool_header(streamByte, resTypePoolOffset)</div><div class="line">// &#x89E3;&#x6790;&#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x503C;</div><div class="line">val resInTypeStringPoolOffset = resTypePoolOffset + resTypeStringPool_header.header.size.getValue()</div><div class="line">val resInTypeStringPool_header = resStringPool_header(streamByte, resInTypeStringPoolOffset)</div><div class="line"></div><div class="line">var resTableTypeSpecOffset = resInTypeStringPoolOffset + resInTypeStringPool_header.header.size.getValue()</div><div class="line"></div><div class="line">var resTypeSpecOffset = resTableTypeSpecOffset</div></pre></td></tr></table></figure>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x9762;&#x89E3;&#x6790;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#xFF0C;&#x5148;&#x89E3;&#x6790;Package&#x6570;&#x636E;&#xFF0C;&#x63A5;&#x7740;&#x89E3;&#x6790;&#x4E86;&#x8D44;&#x6E90;&#x9879;&#x4EE5;&#x53CA;&#x8D44;&#x6E90;&#x9879;&#x7684;&#x503C;&#x3002;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;<br><img src="http://upload-images.jianshu.io/upload_images/5720362-e5554eae0b8221b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Package&#x548C;&#x8D44;&#x6E90;&#x9879;&#x90E8;&#x5206;&#x7ED3;&#x679C;"></p>
</blockquote>
<hr>
<h2 id="10-6-&#x7C7B;&#x578B;&#x89C4;&#x8303;&#x6570;&#x636E;&#x5757;&#x548C;&#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x9879;&#x6570;&#x636E;&#x5757;&#x89E3;&#x6790;"><a href="#10-6-&#x7C7B;&#x578B;&#x89C4;&#x8303;&#x6570;&#x636E;&#x5757;&#x548C;&#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x9879;&#x6570;&#x636E;&#x5757;&#x89E3;&#x6790;" class="headerlink" title="10.6 &#x7C7B;&#x578B;&#x89C4;&#x8303;&#x6570;&#x636E;&#x5757;&#x548C;&#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x9879;&#x6570;&#x636E;&#x5757;&#x89E3;&#x6790;"></a>10.6 &#x7C7B;&#x578B;&#x89C4;&#x8303;&#x6570;&#x636E;&#x5757;&#x548C;&#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x9879;&#x6570;&#x636E;&#x5757;&#x89E3;&#x6790;</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div></pre></td><td class="code"><pre><div class="line">while (resTypeSpecOffset &lt; streamByte.size) {</div><div class="line"></div><div class="line">    if (read_uint16_t(streamByte, resTypeSpecOffset).getValue().toInt() == ResChunk_header.ChunkType.RES_TABLE_TYPE_SPEC_TYPE.type) {</div><div class="line">        val resTable_typeSpec = ResTable_typeSpec(getResChunk_header(streamByte, resTypeSpecOffset),</div><div class="line">                read_uint8_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE),</div><div class="line">                read_uint8_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1),</div><div class="line">                read_uint16_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1),</div><div class="line">                read_uint32_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1 + 2))</div><div class="line">        println(&quot;$resTable_typeSpec, idValue = ${resTypeStringPool_header.stringStringArray!!.stringArray[resTable_typeSpec.id.getValue().toInt() - 1]}&quot;)</div><div class="line"></div><div class="line">        val arrayOfUint32_ts = Array(resTable_typeSpec.entryCount.getValue(), {</div><div class="line">            uint32_t(0)</div><div class="line">        })</div><div class="line"></div><div class="line">        (0..resTable_typeSpec.entryCount.getValue() - 1).forEachIndexed { index, i -&gt;</div><div class="line">            arrayOfUint32_ts[index] = read_uint32_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1 + 2 + 4 + 4 * index)</div><div class="line">        }</div><div class="line">        val res_entry_array = Res_entry_array(arrayOfUint32_ts)</div><div class="line">        println(res_entry_array)</div><div class="line">        resTypeSpecOffset += resTable_typeSpec.header.size.getValue()</div><div class="line">        println(&quot;===========================================&quot;)</div><div class="line">    } else {</div><div class="line">        val resTable_type = ResTable_type(</div><div class="line">                getResChunk_header(streamByte, resTypeSpecOffset),</div><div class="line">                read_uint8_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE),</div><div class="line">                read_uint8_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1),</div><div class="line">                read_uint16_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1),</div><div class="line">                read_uint32_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1 + 2),</div><div class="line">                read_uint32_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1 + 2 + 4),</div><div class="line">                ResTable_config(</div><div class="line">                        read_uint32_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1 + 2 + 4 * 2),</div><div class="line">                        read_uint32_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1 + 2 + 4 * 3),</div><div class="line">                        read_uint32_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1 + 2 + 4 * 4),</div><div class="line">                        read_uint32_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1 + 2 + 4 * 5),</div><div class="line">                        read_uint32_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1 + 2 + 4 * 6),</div><div class="line">                        read_uint32_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1 + 2 + 4 * 7),</div><div class="line">                        read_uint32_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1 + 2 + 4 * 8),</div><div class="line">                        read_uint32_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1 + 2 + 4 * 9),</div><div class="line">                        read_uint32_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1 + 2 + 4 * 10),</div><div class="line">                        read_uint32_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1 + 2 + 4 * 11),</div><div class="line">                        read_uint64_t(streamByte, resTypeSpecOffset + Config.RESCHUNK_HEADER_SIZE + 1 + 1 + 2 + 4 * 12)</div><div class="line">                ))</div><div class="line">        println(resTable_type)</div><div class="line">        var tempOffset = resTypeSpecOffset + resTable_type.header.headerSize.getValue().toInt()</div><div class="line"></div><div class="line">        val arrayOfUint32_ts = Array(resTable_type.entryCount.getValue(), {</div><div class="line">            uint32_t(0)</div><div class="line">        })</div><div class="line"></div><div class="line">        (0..resTable_type.entryCount.getValue() - 1).forEachIndexed { index, i -&gt;</div><div class="line">            arrayOfUint32_ts[index] = read_uint32_t(streamByte, tempOffset + 4 * index)</div><div class="line">        }</div><div class="line"></div><div class="line">        val res_entry_array2 = Res_entry_array(arrayOfUint32_ts)</div><div class="line">        println(res_entry_array2)</div><div class="line"></div><div class="line">        tempOffset += resTable_type.entriesStart.getValue() - resTable_type.header.headerSize.getValue().toInt()</div><div class="line"></div><div class="line">        val resString_string_array = resInTypeStringPool_header.stringStringArray</div><div class="line">        var count = 0</div><div class="line">        var resId = 0</div><div class="line">        while (count &lt; resTable_type.header.size.getValue() - resTable_type.entriesStart.getValue()) {</div><div class="line">            println(&quot;resId = ${Integer.toHexString(resId)}&quot;)</div><div class="line">            val size = read_uint16_t(streamByte, tempOffset + count)</div><div class="line">            val flags = read_uint16_t(streamByte, tempOffset + count + 2)</div><div class="line">            if (flags.getValue().toInt() == 1) {</div><div class="line">                val resTable_map_entry = ResTable_map_entry(size,</div><div class="line">                        flags,</div><div class="line">                        ResStringPool_ref(read_uint32_t(streamByte, tempOffset + count + 2 + 2)),</div><div class="line">                        ResTable_ref(read_uint32_t(streamByte, tempOffset + count + 2 + 2 + 4)),</div><div class="line">                        read_uint32_t(streamByte, tempOffset + count + 2 + 2 + 4 + 4))</div><div class="line"></div><div class="line">                val mapStr = resTable_map_entry.key!!.index.getValue()</div><div class="line">                resTable_map_entry.dataStr = resInTypeStringPool_header.stringStringArray!!.stringArray[mapStr]</div><div class="line">                println(resTable_map_entry)</div><div class="line">                count += resTable_map_entry.size.getValue().toInt()</div><div class="line">                println(resString_string_array!!.stringArray[mapStr])</div><div class="line">                println(&quot;--------------------------resTable_map start------------------------------&quot;)</div><div class="line">                for (index in 0..resTable_map_entry.count.getValue() - 1) {</div><div class="line">                    val resTable_map = ResTable_map(</div><div class="line">                            ResTable_ref(</div><div class="line">                                    read_uint32_t(streamByte, tempOffset)),</div><div class="line">                            Res_value(</div><div class="line">                                    read_uint16_t(streamByte, tempOffset + 4),</div><div class="line">                                    read_uint8_t(streamByte, tempOffset + 4 + 2),</div><div class="line">                                    read_uint8_t(streamByte, tempOffset + 4 + 2 + 1),</div><div class="line">                                    read_uint32_t(streamByte, tempOffset + 4 + 2 + 1 + 1)))</div><div class="line">                    println(resTable_map)</div><div class="line">                    count += Config.RESTABLE_MAP_SIZE</div><div class="line">                }</div><div class="line">                println(&quot;--------------------------resTable_map end------------------------------&quot;)</div><div class="line">            } else {</div><div class="line">                val resTable_entry = ResTable_entry(size, flags, ResStringPool_ref(read_uint32_t(streamByte, tempOffset + count + 2 + 2)))</div><div class="line">                val index = resTable_entry.key!!.index.getValue()</div><div class="line">                if (index &gt; 0 &amp;&amp; index &lt;= resInTypeStringPool_header.stringStringArray!!.stringArray.size - 1) {</div><div class="line">                    resTable_entry.dataStr = resInTypeStringPool_header.stringStringArray!!.stringArray[index]</div><div class="line">                }</div><div class="line">                count += 8</div><div class="line">                val res_value = Res_value(read_uint16_t(streamByte, tempOffset + count),</div><div class="line">                        read_uint8_t(streamByte, tempOffset + count + 2)</div><div class="line">                        , read_uint8_t(streamByte, tempOffset + count + 2 + 1),</div><div class="line">                        read_uint32_t(streamByte, tempOffset + count + 2 + 1 + 1))</div><div class="line">                println(&quot;--------------------------resTable_entry start------------------------------&quot;)</div><div class="line">                println(resTable_entry)</div><div class="line">                println(&quot;--------------------------resTable_entry end------------------------------&quot;)</div><div class="line">                println(&quot;--------------------------res_value start------------------------------&quot;)</div><div class="line">                println(res_value)</div><div class="line">                println(&quot;--------------------------res_value end------------------------------&quot;)</div><div class="line">                count += Config.RES_VALUE_SIZE</div><div class="line">            }</div><div class="line"></div><div class="line">            resId++</div><div class="line">        }</div><div class="line">        resTypeSpecOffset += resTable_type.header.size.getValue()</div><div class="line">        println(&quot;===========================================&quot;)</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>
<blockquote>
<p>&#x8FD9;&#x90E8;&#x5206;&#x89E3;&#x6790;&#x5176;&#x5B9E;&#x5F88;&#x7E41;&#x7410;&#xFF0C;&#x9996;&#x5148;ResTable_typeSpec&#x548C;ResTable_type&#x662F;&#x6210;&#x5BF9;&#x51FA;&#x73B0;&#xFF08;&#x901A;&#x8FC7;&#x73B0;&#x8C61;&#x5F97;&#x51FA;&#x7ED3;&#x8BBA;&#x3002;&#x3002;&#xFF09;&#xFF0C;ResTable_typeSpec&#x91CC;&#x9762;&#x5305;&#x62EC;&#x4E86;&#x8BE5;&#x8D44;&#x6E90;&#x9879;&#x5BF9;&#x5E94;&#x7684;id&#xFF08;&#x8FD9;&#x4E2A;id&#x5BF9;&#x5E94;&#x7684;&#x662F;&#x89E3;&#x6790;&#x8D44;&#x6E90;&#x9879;&#x7ED3;&#x679C;&#x7684;&#x7D22;&#x5F15;+1&#xFF09;&#x4EE5;&#x53CA;&#x8D44;&#x6E90;&#x9879;&#x4E2A;&#x6570;&#xFF0C;&#x63A5;&#x7740;&#x4FBF;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF08;&#x5177;&#x4F53;&#x7528;&#x5904;&#x4E0D;&#x8BE6;&#xFF09;&#xFF0C;&#x63A5;&#x7740;&#x4FBF;&#x662F;ResTable_type&#xFF0C;&#x8FD9;&#x91CC;&#x9762;&#x5B9A;&#x4E49;&#x4E86;&#x8D44;&#x6E90;&#x7684;type id&#xFF0C;&#x8D44;&#x6E90;&#x9879;&#x503C;&#x7684;&#x603B;&#x4E2A;&#x6570;&#xFF0C;&#x5F00;&#x59CB;&#x4F4D;&#x7F6E;&#x7684;&#x504F;&#x79FB;&#x91CF;&#x4EE5;&#x53CA;&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#x3002;&#x987A;&#x4FBF;&#x8BF4;&#x4E00;&#x53E5;&#xFF0C;&#x6211;&#x8FD9;&#x4E2A;&#x89E3;&#x6790;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x901A;&#x8FC7;&#x7684;&#x662F;&#x6574;&#x4F53;&#x7684;size&#x6765;&#x5224;&#x65AD;&#x662F;&#x5426;&#x89E3;&#x6790;&#x5B8C;&#x6210;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x6839;&#x636E;entryCount&#x6765;&#x5224;&#x65AD;&#xFF0C;&#x8FD9;&#x91CC;&#x548C;&#x5176;&#x4ED6;&#x89E3;&#x6790;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x4E9B;&#x51FA;&#x5165;&#x3002;&#x89E3;&#x6790;&#x5B8C;ResTable_type&#xFF0C;&#x89E3;&#x6790;&#x5B8C;&#x6210;ResTable_type&#x8FD8;&#x9700;&#x8981;&#x6839;&#x636E;entryCount&#x6765;&#x89E3;&#x6790;&#x4E00;&#x4E2A;&#x4FBF;&#x5B9C;&#x6570;&#x7EC4;&#xFF0C;&#x63A5;&#x7740;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x540E;&#x9762;&#x89E3;&#x6790;&#x7684;flags&#x6765;&#x5224;&#x65AD;&#x8D44;&#x6E90;&#x9879;&#x7684;&#x503C;&#x662F;ResTable_entry&#x8FD8;&#x662F;ResTable_map_entry&#xFF0C;&#x5982;&#x679C;&#x662F;ResTable_entry&#x7684;&#x8BDD;&#xFF0C;&#x5219;&#x6DFB;&#x52A0;&#x5BF9;Res_value&#x7684;&#x89E3;&#x6790;&#xFF0C;&#x5982;&#x679C;&#x662F;ResTable_map_entry&#xFF0C;&#x5219;&#x6DFB;&#x52A0;&#x5BF9;ResTable_map&#x7684;&#x89E3;&#x6790;&#x3002;<br>&#x90E8;&#x5206;&#x89E3;&#x6790;&#x7ED3;&#x679C;&#xFF1A;<br><img src="http://upload-images.jianshu.io/upload_images/5720362-45d7ebba8a597660.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ResTable_typeSpec&#x7ED3;&#x679C;"><br><img src="http://upload-images.jianshu.io/upload_images/5720362-86cd054b4ce38725.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ResTable_type&#x7ED3;&#x679C;"></p>
</blockquote>
<hr>
<h1 id="&#x5199;&#x5728;&#x540E;&#x9762;&#x7684;&#x8BDD;"><a href="#&#x5199;&#x5728;&#x540E;&#x9762;&#x7684;&#x8BDD;" class="headerlink" title="&#x5199;&#x5728;&#x540E;&#x9762;&#x7684;&#x8BDD;"></a>&#x5199;&#x5728;&#x540E;&#x9762;&#x7684;&#x8BDD;</h1><blockquote>
<p>&#x6574;&#x4E2A;&#x89E3;&#x6790;&#x8FC7;&#x7A0B;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#x4E86;&#xFF0C;&#x4EE3;&#x7801;<a href="https://github.com/mcksuu/resourcesAnalyzer" target="_blank" rel="external">&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x770B;&#x5230;</a>&#x3002;<br>&#x603B;&#x7ED3;&#x4E0B;&#xFF0C;&#x8FD8;&#x662F;&#x4E0D;&#x8981;&#x778E;&#x641E;&#x4E8B;&#x60C5;&#x554A;&#x3002;&#x672C;&#x6765;&#x81EA;&#x5DF1;&#x6709;&#x6253;&#x7B97;&#x4E00;&#x6B65;&#x6B65;&#x6765;&#x7684;&#xFF0C;&#x7ED3;&#x679C;&#x534A;&#x8DEF;&#x770B;&#x5230;&#x8FD9;&#x4E2A;&#x65AD;&#x65AD;&#x7EED;&#x7EED;&#x641E;&#x4E86;&#x4E24;&#x5468;&#x65F6;&#x95F4;&#xFF0C;&#x5176;&#x4E2D;&#x5FC3;&#x9178;&#x7684;&#x5386;&#x7A0B;&#x4E0D;&#x591A;&#x8BF4;&#x4E86;&#xFF0C;&#x4E0D;&#x65AD;&#x7684;&#x80AF;&#x5B9A;&#x81EA;&#x5DF1;&#x53C8;&#x4E0D;&#x65AD;&#x7684;&#x5426;&#x5B9A;&#x81EA;&#x5DF1;&#x3002;&#x4E0D;&#x8FC7;&#x5462;&#xFF0C;&#x6700;&#x540E;&#x7EC8;&#x4E8E;&#x7B97;&#x662F;&#x5C06;&#x4E1C;&#x897F;&#x5B8C;&#x6210;&#x4E86;&#x3002;&#x4EE5;&#x524D;&#x89C9;&#x5F97;&#x5427;&#xFF0C;&#x7AD9;&#x5728;&#x5DE8;&#x4EBA;&#x7684;&#x80A9;&#x8180;&#x4E0A;&#x770B;&#x4E16;&#x754C;&#xFF0C;&#x5F88;&#x8F7B;&#x677E;&#x3002;&#x540E;&#x6765;&#x53D1;&#x73B0;&#xFF0C;&#x5DE8;&#x4EBA;&#x7684;&#x80A9;&#x8180;&#x53EF;&#x80FD;&#x4E5F;&#x6709;&#x6F0F;&#x6D1E;&#x3002;<br><img src="http://upload-images.jianshu.io/upload_images/5720362-44534b4b3cbfa37f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
</blockquote>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/12/13/View的测量、布局和绘制过程/" rel="next" title="View的测量、布局和绘制过程">
                <i class="fa fa-chevron-left"></i> View的测量、布局和绘制过程
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/12/20/Android触摸事件（上）——事件的由来/" rel="prev" title="Android触摸事件（上）——事件的由来">
                Android触摸事件（上）——事件的由来 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/favicon.png"
               alt="Nick Kang" />
          <p class="site-author-name" itemprop="name">Nick Kang</p>
          <p class="site-description motion-element" itemprop="description">风轻云淡，勿忘本心</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">18</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#写在前面的话"><span class="nav-number">1.</span> <span class="nav-text">写在前面的话</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1-关于resources-arsc的网传神图"><span class="nav-number">2.</span> <span class="nav-text">1. 关于resources.arsc的网传神图</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-resources-arsc格式详细分析"><span class="nav-number">3.</span> <span class="nav-text">2. resources.arsc格式详细分析</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-先说说头部信息"><span class="nav-number">4.</span> <span class="nav-text">3. 先说说头部信息</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-package数量格式"><span class="nav-number">5.</span> <span class="nav-text">4. package数量格式</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-String-Pool"><span class="nav-number">6.</span> <span class="nav-text">5. String Pool</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-Package信息"><span class="nav-number">7.</span> <span class="nav-text">6. Package信息</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-资源类型字符串池和资源项名称字符串池"><span class="nav-number">8.</span> <span class="nav-text">7. 资源类型字符串池和资源项名称字符串池</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-类型规范数据块"><span class="nav-number">9.</span> <span class="nav-text">8. 类型规范数据块</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-资源类型项数据块"><span class="nav-number">10.</span> <span class="nav-text">9. 资源类型项数据块</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#10-解析过程"><span class="nav-number">11.</span> <span class="nav-text">10. 解析过程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#10-1-工具类和类型定义"><span class="nav-number">11.1.</span> <span class="nav-text">10.1  工具类和类型定义</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-2-文件读取和字节数组转换"><span class="nav-number">11.2.</span> <span class="nav-text">10.2  文件读取和字节数组转换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-3-解析ResTable-header信息"><span class="nav-number">11.3.</span> <span class="nav-text">10.3 解析ResTable_header信息</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#10-4-解析字符串资源池"><span class="nav-number">12.</span> <span class="nav-text">10.4 解析字符串资源池</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#10-5-Package信息解析"><span class="nav-number">12.1.</span> <span class="nav-text">10.5 Package信息解析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-6-类型规范数据块和资源类型项数据块解析"><span class="nav-number">12.2.</span> <span class="nav-text">10.6 类型规范数据块和资源类型项数据块解析</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#写在后面的话"><span class="nav-number">13.</span> <span class="nav-text">写在后面的话</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Nick Kang</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  




  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

  


</body>
</html>
